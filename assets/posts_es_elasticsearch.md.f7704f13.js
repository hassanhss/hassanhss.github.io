import{_ as t,o as e,c as o,f as u}from"./app.4fa09c86.js";var n="/assets/dbvses.38f397da.png",a="/assets/datatype.c603a512.png",q="/assets/dynamicmapping.8c60da44.png",r="/assets/ik.c1d4b3a7.png",i="/assets/inverted_one.02dc9681.png",l="/assets/inverted_two.4a34d6a3.png",s="/assets/inverted_three.f7daafa9.png",d="/assets/inverted_four.09722811.png",p="/assets/deeppage.663b5daa.png";const I='{"title":"Elasticsearch\u67E5\u8BE2\u5E38\u89C1\u95EE\u9898","description":"\u67E5\u8BE2\u5E38\u89C1\u95EE\u9898","frontmatter":{"date":"2024-11-15T00:00:00.000Z","title":"Elasticsearch\u67E5\u8BE2\u5E38\u89C1\u95EE\u9898","tags":["es"],"description":"\u67E5\u8BE2\u5E38\u89C1\u95EE\u9898"},"headers":[{"level":2,"title":"\u6570\u636E\u7C7B\u578B","slug":"\u6570\u636E\u7C7B\u578B"},{"level":3,"title":"\u7B80\u5355\u6570\u636E\u7C7B\u578B","slug":"\u7B80\u5355\u6570\u636E\u7C7B\u578B"},{"level":3,"title":"\u590D\u6742\u6570\u636E\u7C7B\u578B","slug":"\u590D\u6742\u6570\u636E\u7C7B\u578B"},{"level":2,"title":"\u521B\u5EFA\u7D22\u5F15","slug":"\u521B\u5EFA\u7D22\u5F15"},{"level":2,"title":"setting\u8BBE\u7F6E","slug":"setting\u8BBE\u7F6E"},{"level":2,"title":"mapping\u8BBE\u7F6E","slug":"mapping\u8BBE\u7F6E"},{"level":3,"title":"Dynamic Mapping\u81EA\u52A8\u521B\u5EFAmapping","slug":"dynamic-mapping\u81EA\u52A8\u521B\u5EFAmapping"},{"level":2,"title":"\u5206\u8BCD","slug":"\u5206\u8BCD"},{"level":3,"title":"\u5E38\u7528\u5206\u8BCD\u5668","slug":"\u5E38\u7528\u5206\u8BCD\u5668"},{"level":3,"title":"IK \u5206\u8BCD\u5668","slug":"ik-\u5206\u8BCD\u5668"},{"level":3,"title":"\u6D4B\u8BD5\u5206\u8BCD\u5668","slug":"\u6D4B\u8BD5\u5206\u8BCD\u5668"},{"level":3,"title":"\u521B\u5EFA\u7D22\u5F15\u6267\u884C\u5206\u8BCD\u5668","slug":"\u521B\u5EFA\u7D22\u5F15\u6267\u884C\u5206\u8BCD\u5668"},{"level":3,"title":"\u5206\u8BCD\u5DE5\u4F5C\u6D41\u7A0B","slug":"\u5206\u8BCD\u5DE5\u4F5C\u6D41\u7A0B"},{"level":2,"title":"\u4EC0\u4E48\u662F\u5012\u6392\u7D22\u5F15","slug":"\u4EC0\u4E48\u662F\u5012\u6392\u7D22\u5F15"},{"level":3,"title":"\u5012\u6392\u7D22\u5F15\u6570\u636E\u7ED3\u6784","slug":"\u5012\u6392\u7D22\u5F15\u6570\u636E\u7ED3\u6784"},{"level":3,"title":"\u5012\u6392\u7D22\u5F15\u7684\u751F\u6210","slug":"\u5012\u6392\u7D22\u5F15\u7684\u751F\u6210"},{"level":3,"title":"\u67E5\u8BE2","slug":"\u67E5\u8BE2"},{"level":3,"title":"TF\u3001IDF","slug":"tf\u3001idf"},{"level":2,"title":"\u641C\u7D22\u8BED\u6CD5","slug":"\u641C\u7D22\u8BED\u6CD5"},{"level":3,"title":"match_all \u67E5\u8BE2\u6240\u6709\u6587\u6863","slug":"match-all-\u67E5\u8BE2\u6240\u6709\u6587\u6863"},{"level":3,"title":"match \u5355\u4E2A\u5B57\u6BB5\u5339\u914D","slug":"match-\u5355\u4E2A\u5B57\u6BB5\u5339\u914D"},{"level":3,"title":"multi_match \u591A\u5B57\u6BB5\u5339\u914D","slug":"multi-match-\u591A\u5B57\u6BB5\u5339\u914D"},{"level":3,"title":"match_phrase \u77ED\u8BED\u5339\u914D","slug":"match-phrase-\u77ED\u8BED\u5339\u914D"},{"level":3,"title":"term \u5355\u503C\u7CBE\u786E\u67E5\u8BE2","slug":"term-\u5355\u503C\u7CBE\u786E\u67E5\u8BE2"},{"level":3,"title":"terms \u591A\u503C\u7CBE\u786E\u5339\u914D","slug":"terms-\u591A\u503C\u7CBE\u786E\u5339\u914D"},{"level":3,"title":"prefix \u524D\u7F00\u5339\u914D","slug":"prefix-\u524D\u7F00\u5339\u914D"},{"level":3,"title":"wildcard \u901A\u914D\u7B26\u5339\u914D","slug":"wildcard-\u901A\u914D\u7B26\u5339\u914D"},{"level":3,"title":"regexp \u6B63\u5219\u5339\u914D","slug":"regexp-\u6B63\u5219\u5339\u914D"},{"level":3,"title":"fuzzy \u8FD1\u4F3C\u5339\u914D","slug":"fuzzy-\u8FD1\u4F3C\u5339\u914D"},{"level":3,"title":"range \u533A\u95F4\u5339\u914D","slug":"range-\u533A\u95F4\u5339\u914D"},{"level":3,"title":"exists \u5339\u914D\u6307\u5B9A\u5B57\u6BB5\u975E\u7A7A\u7684\u6587\u6863","slug":"exists-\u5339\u914D\u6307\u5B9A\u5B57\u6BB5\u975E\u7A7A\u7684\u6587\u6863"},{"level":3,"title":"ids id\u6570\u503C\u5339\u914D","slug":"ids-id\u6570\u503C\u5339\u914D"},{"level":3,"title":"term\u3001match \u533A\u522B","slug":"term\u3001match-\u533A\u522B"},{"level":3,"title":"bool \u5E03\u5C14\u67E5\u8BE2","slug":"bool-\u5E03\u5C14\u67E5\u8BE2"},{"level":3,"title":"query_string \u5B57\u7B26\u4E32\u5339\u914D","slug":"query-string-\u5B57\u7B26\u4E32\u5339\u914D"},{"level":2,"title":"\u5206\u9875","slug":"\u5206\u9875"},{"level":3,"title":"from + size \u5206\u9875\u64CD\u4F5C\u4E0E\u6DF1\u5206\u9875\u95EE\u9898","slug":"from-size-\u5206\u9875\u64CD\u4F5C\u4E0E\u6DF1\u5206\u9875\u95EE\u9898"},{"level":3,"title":"search after","slug":"search-after"},{"level":3,"title":"scroll API","slug":"scroll-api"},{"level":3,"title":"PIT","slug":"pit"},{"level":2,"title":"\u7CBE\u786E\u5339\u914D","slug":"\u7CBE\u786E\u5339\u914D"},{"level":3,"title":"\u5FFD\u7565\u5927\u5C0F\u5199","slug":"\u5FFD\u7565\u5927\u5C0F\u5199"},{"level":2,"title":"\u5206\u8BCD\u6280\u5DE7","slug":"\u5206\u8BCD\u6280\u5DE7"},{"level":2,"title":"\u8FD4\u56DE\u6570\u636E\u5177\u4F53\u603B\u6761\u6570","slug":"\u8FD4\u56DE\u6570\u636E\u5177\u4F53\u603B\u6761\u6570"},{"level":2,"title":"\u8FD4\u56DE\u6307\u5B9A\u5B57\u6BB5","slug":"\u8FD4\u56DE\u6307\u5B9A\u5B57\u6BB5"},{"level":2,"title":"copy_to","slug":"copy-to"},{"level":2,"title":"\u6267\u884C\u6027\u80FD","slug":"\u6267\u884C\u6027\u80FD"},{"level":2,"title":"Term Suggester","slug":"term-suggester"}],"relativePath":"posts/es/elasticsearch.md"}',h={},c=u('<h1 id="\u57FA\u672C\u6982\u5FF5" tabindex="-1">\u57FA\u672C\u6982\u5FF5 <a class="header-anchor" href="#\u57FA\u672C\u6982\u5FF5" aria-hidden="true">#</a></h1><ul><li><p>Cluster \u96C6\u7FA4\uFF1A\u7531\u591A\u4E2A\u534F\u540C\u5DE5\u4F5C\u7684 ES \u5B9E\u4F8B\u7EC4\u5408\u6210\u7684\u96C6\u5408\uFF0C\u4E00\u4E2A\u96C6\u7FA4\u7531\u4E00\u4E2A\u552F\u4E00\u7684\u540D\u5B57\u6807\u8BC6</p></li><li><p>Node \u8282\u70B9\uFF1A\u5355\u4E2A ES \u7684\u670D\u52A1\u5B9E\u4F8B\u53EB\u505A\u8282\u70B9\uFF0C\u672C\u8D28\u4E0A\u5C31\u662F\u4E00\u4E2A Java \u8FDB\u7A0B\uFF0C\u5B58\u50A8\u96C6\u7FA4\u7684\u6570\u636E\uFF0C\u53C2\u4E0E\u96C6\u7FA4\u7684\u7D22\u5F15\u548C\u641C\u7D22\u529F\u80FD</p><ul><li>\u4E3B\u8282\u70B9\uFF08Master\uFF09\u3002\u4E3B\u8282\u70B9\u5728\u6574\u4E2A\u96C6\u7FA4\u662F\u552F\u4E00\u7684\uFF0CMaster \u4ECE\u6709\u8D44\u683C\u8FDB\u884C\u9009\u4E3E\u7684\u8282\u70B9\uFF08Master Eligible\uFF09\u4E2D\u9009\u4E3E\u51FA\u6765\u3002\u4E3B\u8282\u70B9\u4E3B\u8981\u8D1F\u8D23\u7BA1\u7406\u96C6\u7FA4\u53D8\u66F4\u3001\u5143\u6570\u636E\u7684\u66F4\u6539</li><li>\u6570\u636E\u8282\u70B9\uFF08Data Node\uFF09\u3002\u5176\u8D1F\u8D23\u4FDD\u5B58\u6570\u636E\uFF0C\u8981\u6269\u5145\u5B58\u50A8\u65F6\u5019\u9700\u8981\u6269\u5C55\u8FD9\u7C7B\u8282\u70B9\u3002\u6570\u636E\u8282\u70B9\u8FD8\u8D1F\u8D23\u6267\u884C\u6570\u636E\u76F8\u5173\u7684\u64CD\u4F5C\uFF0C\u5982\uFF1A\u641C\u7D22\u3001\u805A\u5408\u3001CURD \u7B49\u3002\u6240\u4EE5\u5BF9\u8282\u70B9\u673A\u5668\u7684 CPU\u3001\u5185\u5B58\u3001I/O \u8981\u6C42\u90FD\u6BD4\u8F83\u9AD8</li><li>\u534F\u8C03\u8282\u70B9\uFF08Coordinating Node\uFF09\u3002\u8D1F\u8D23\u63A5\u53D7\u5BA2\u6237\u7AEF\u7684\u8BF7\u6C42\uFF0C\u5C06\u8BF7\u6C42\u8DEF\u7531\u5230\u5BF9\u5E94\u7684\u8282\u70B9\u8FDB\u884C\u5904\u7406\uFF0C\u5E76\u4E14\u628A\u6700\u7EC8\u7ED3\u679C\u6C47\u603B\u5230\u4E00\u8D77\u8FD4\u56DE\u7ED9\u5BA2\u6237\u7AEF\u3002\u56E0\u4E3A\u9700\u8981\u5904\u7406\u7ED3\u679C\u96C6\u548C\u5BF9\u5176\u8FDB\u884C\u6392\u5E8F\uFF0C\u9700\u8981\u8F83\u9AD8\u7684 CPU \u548C\u5185\u5B58\u8D44\u6E90</li></ul></li><li><p>Index \u7D22\u5F15: \u4E00\u4E2A\u7D22\u5F15\u662F\u4E00\u4E2A\u6587\u6863\u7684\u96C6\u5408\u3002\u6BCF\u4E2A\u7D22\u5F15\u6709\u552F\u4E00\u7684\u540D\u5B57\uFF0C\u901A\u8FC7\u8FD9\u4E2A\u540D\u5B57\u6765\u64CD\u4F5C\u5B83\u3002\u4E00\u4E2A\u96C6\u7FA4\u4E2D\u53EF\u4EE5\u6709\u4EFB\u610F\u591A\u4E2A\u7D22\u5F15</p></li><li><p>Type \u7C7B\u578B\uFF1A\u6307\u5728\u4E00\u4E2A\u7D22\u5F15\u4E2D\uFF0C\u53EF\u4EE5\u7D22\u5F15\u4E0D\u540C\u7C7B\u578B\u7684\u6587\u6863\uFF0C\u5982\u7528\u6237\u6570\u636E\u3001\u5546\u54C1\u6570\u636E\u3002\u4ECE6.0.0 \u7248\u672C\u8D77\u5DF2\u5E9F\u5F03\uFF0C\u4E00\u4E2A\u7D22\u5F15\u4E2D\u53EA\u5B58\u653E\u4E00\u7C7B\u6570\u636E</p></li><li><p>Document \u6587\u6863\uFF1A\u88AB\u7D22\u5F15\u7684\u4E00\u6761\u6570\u636E\uFF0C\u7D22\u5F15\u7684\u57FA\u672C\u4FE1\u606F\u5355\u5143\uFF0C\u4EE5JSON\u683C\u5F0F\u6765\u8868\u793A</p></li><li><p>Shard \u5206\u7247\uFF1A\u5728\u521B\u5EFA\u4E00\u4E2A\u7D22\u5F15\u65F6\u53EF\u4EE5\u6307\u5B9A\u5206\u6210\u591A\u5C11\u4E2A\u5206\u7247\u6765\u5B58\u50A8\u3002\u6BCF\u4E2A\u5206\u7247\u672C\u8EAB\u4E5F\u662F\u4E00\u4E2A\u529F\u80FD\u5B8C\u5584\u4E14\u72EC\u7ACB\u7684\u201C\u7D22\u5F15\u201D\uFF0C\u53EF\u4EE5\u88AB\u653E\u7F6E\u5728\u96C6\u7FA4\u7684\u4EFB\u610F\u8282\u70B9\u4E0A\u3002\u5206\u7247\u7684\u597D\u5904\u662F\u5141\u8BB8\u6211\u4EEC\u6C34\u5E73\u5207\u5206/\u6269\u5C55\u5BB9\u91CF\u53EF\u5728\u591A\u4E2A\u5206\u7247\u4E0A\u8FDB\u884C\u5206\u5E03\u5F0F\u7684\u3001\u5E76\u884C\u7684\u64CD\u4F5C\uFF0C\u63D0\u9AD8\u7CFB\u7EDF\u7684\u6027\u80FD\u548C\u541E\u5410\u91CF</p></li><li><p>Replication \u5907\u4EFD: \u4E00\u4E2A\u5206\u7247\u53EF\u4EE5\u6709\u591A\u4E2A\u5907\u4EFD\uFF08\u526F\u672C\uFF09</p></li></ul><p>\u5173\u7CFB\u6570\u636E\u5E93\u548Celasticsearch\u5BF9\u6BD4\u5982\u4E0B</p><p><img src="'+n+'" alt=""></p><h1 id="\u7D22\u5F15\u64CD\u4F5C" tabindex="-1">\u7D22\u5F15\u64CD\u4F5C <a class="header-anchor" href="#\u7D22\u5F15\u64CD\u4F5C" aria-hidden="true">#</a></h1><h2 id="\u6570\u636E\u7C7B\u578B" tabindex="-1">\u6570\u636E\u7C7B\u578B <a class="header-anchor" href="#\u6570\u636E\u7C7B\u578B" aria-hidden="true">#</a></h2><h3 id="\u7B80\u5355\u6570\u636E\u7C7B\u578B" tabindex="-1">\u7B80\u5355\u6570\u636E\u7C7B\u578B <a class="header-anchor" href="#\u7B80\u5355\u6570\u636E\u7C7B\u578B" aria-hidden="true">#</a></h3><p><img src="'+a+`" alt=""></p><h3 id="\u590D\u6742\u6570\u636E\u7C7B\u578B" tabindex="-1">\u590D\u6742\u6570\u636E\u7C7B\u578B <a class="header-anchor" href="#\u590D\u6742\u6570\u636E\u7C7B\u578B" aria-hidden="true">#</a></h3><h4 id="\u6570\u636E\u7C7B\u578B-1" tabindex="-1">\u6570\u636E\u7C7B\u578B <a class="header-anchor" href="#\u6570\u636E\u7C7B\u578B-1" aria-hidden="true">#</a></h4><ul><li>\u5B57\u7B26\u4E32\u6570\u7EC4\uFF1A[&quot;tom&quot;,&quot;jerry&quot;]</li><li>\u6574\u6570\u6570\u7EC4\uFF1A[1,2,3]</li><li>\u7531\u6570\u7EC4\u7EC4\u6210\u7684\u6570\u7EC4\uFF1A[1,[2,3]],\u7B49\u4EF7\u4E8E[1,2,3]</li><li>\u5BF9\u8C61\u6570\u7EC4\uFF1A[{&quot;name&quot;: &quot;Tom&quot;, &quot;age&quot;: 20}, {&quot;name&quot;: &quot;Jerry&quot;, &quot;age&quot;: 18}]</li></ul><p>\u6CE8\u610F\uFF1A</p><ul><li>\u52A8\u6001\u6DFB\u52A0\u6570\u636E\u65F6, \u6570\u7EC4\u4E2D\u7B2C\u4E00\u4E2A\u503C\u7684\u7C7B\u578B\u51B3\u5B9A\u6574\u4E2A\u6570\u7EC4\u7684\u7C7B\u578B</li><li>\u4E0D\u652F\u6301\u6DF7\u5408\u6570\u7EC4\u7C7B\u578B, \u6BD4\u5982[1, \u201Cabc\u201D]</li><li>\u6570\u7EC4\u53EF\u4EE5\u5305\u542Bnull\u503C, \u7A7A\u6570\u7EC4[]\u4F1A\u88AB\u5F53\u505Amissing field \u2014\u2014 \u6CA1\u6709\u503C\u7684\u5B57\u6BB5</li></ul><h4 id="\u5BF9\u8C61\u7C7B\u578B" tabindex="-1">\u5BF9\u8C61\u7C7B\u578B <a class="header-anchor" href="#\u5BF9\u8C61\u7C7B\u578B" aria-hidden="true">#</a></h4><div class="language-"><pre><code>{
    &quot;name&quot;: &quot;tom&quot;,
    &quot;address&quot;: {
        &quot;region&quot;: &quot;China&quot;,
        &quot;location&quot;: {&quot;province&quot;: &quot;ZheJiang&quot;, &quot;city&quot;: &quot;HangZhou&quot;}
    }
}
</code></pre></div><h4 id="\u5D4C\u5957\u7C7B\u578B" tabindex="-1">\u5D4C\u5957\u7C7B\u578B <a class="header-anchor" href="#\u5D4C\u5957\u7C7B\u578B" aria-hidden="true">#</a></h4><p>\u5D4C\u5957\u7C7B\u578B\u662F\u5BF9\u8C61\u7C7B\u578B\u7684\u7279\u4F8B\uFF0C\u53EF\u4EE5\u8BA9array\u7C7B\u578B\u7684\u5BF9\u8C61\u88AB\u72EC\u7ACB\u7D22\u5F15\u548C\u641C\u7D22</p><p>\u5982\u679C\u9700\u8981\u5BF9\u4EE5\u5BF9\u8C61\u8FDB\u884C\u7D22\u5F15, \u4E14\u4FDD\u7559\u6570\u7EC4\u4E2D\u6BCF\u4E2A\u5BF9\u8C61\u7684\u72EC\u7ACB\u6027, \u5C31\u5E94\u8BE5\u4F7F\u7528\u5D4C\u5957\u6570\u636E\u7C7B\u578B</p><div class="language-"><pre><code># \u521B\u5EFA\u6587\u6863
{
  &quot;group&quot;: &quot;stark&quot;,
	&quot;performer&quot;: [
        {&quot;first&quot;: &quot;John&quot;, &quot;last&quot;: &quot;Snow&quot;},
        {&quot;first&quot;: &quot;Sansa&quot;, &quot;last&quot;: &quot;Stark&quot;}
    ]
}
</code></pre></div><p>\u641C\u7D22</p><div class="language-"><pre><code>{
    &quot;query&quot;: {
        &quot;nested&quot;: {
            &quot;path&quot;: &quot;performer&quot;,
            &quot;query&quot;: {
                &quot;bool&quot;: {
                    &quot;must&quot;: [
                        { &quot;match&quot;: { &quot;performer.first&quot;: &quot;John&quot; }},
                        { &quot;match&quot;: { &quot;performer.last&quot;:  &quot;Snow&quot; }} 
                    ]
                }
            }
        }
    }
}
</code></pre></div><h4 id="\u7279\u6B8A\u7C7B\u578B" tabindex="-1">\u7279\u6B8A\u7C7B\u578B <a class="header-anchor" href="#\u7279\u6B8A\u7C7B\u578B" aria-hidden="true">#</a></h4><p>\u5730\u7406\u5F62\u72B6\u7C7B\u578B \u3001IP\u7C7B\u578B\u7B49\u7B49</p><h2 id="\u521B\u5EFA\u7D22\u5F15" tabindex="-1">\u521B\u5EFA\u7D22\u5F15 <a class="header-anchor" href="#\u521B\u5EFA\u7D22\u5F15" aria-hidden="true">#</a></h2><p>\u521B\u5EFA\u7D22\u5F15</p><div class="language-"><pre><code>PUT /my_index
{
  # settings
  # mappings
}
</code></pre></div><h2 id="setting\u8BBE\u7F6E" tabindex="-1">setting\u8BBE\u7F6E <a class="header-anchor" href="#setting\u8BBE\u7F6E" aria-hidden="true">#</a></h2><div class="language-"><pre><code>{
  &quot;settings&quot;: {
    # \u4E3B\u5206\u7247\u6570
    &quot;number_of_shards&quot;: 5,
    # \u526F\u672C\u5206\u7247\u6570
    &quot;number_of_replicas&quot;: 1,
    # \u8BBE\u7F6E\u4E00\u4E9B\u8FC7\u6EE4\u5668
    &quot;analysis&quot;: {
      # keyword\u7C7B\u578B\u641C\u7D22\u5FFD\u7565\u5927\u5C0F\u5199
      &quot;normalizer&quot;: {
        &quot;lowercase_normalizer&quot;: {
          &quot;type&quot;: &quot;custom&quot;,
          &quot;char_filter&quot;: [],
          &quot;filter&quot;: [
            &quot;lowercase&quot;
          ]
        }
      }
    }
  },
  &quot;mappings&quot;: {}
}
</code></pre></div><h2 id="mapping\u8BBE\u7F6E" tabindex="-1">mapping\u8BBE\u7F6E <a class="header-anchor" href="#mapping\u8BBE\u7F6E" aria-hidden="true">#</a></h2><h3 id="dynamic-mapping\u81EA\u52A8\u521B\u5EFAmapping" tabindex="-1">Dynamic Mapping\u81EA\u52A8\u521B\u5EFAmapping <a class="header-anchor" href="#dynamic-mapping\u81EA\u52A8\u521B\u5EFAmapping" aria-hidden="true">#</a></h3><p><img src="`+q+`" alt=""></p><h2 id="\u5206\u8BCD" tabindex="-1">\u5206\u8BCD <a class="header-anchor" href="#\u5206\u8BCD" aria-hidden="true">#</a></h2><h3 id="\u5E38\u7528\u5206\u8BCD\u5668" tabindex="-1">\u5E38\u7528\u5206\u8BCD\u5668 <a class="header-anchor" href="#\u5E38\u7528\u5206\u8BCD\u5668" aria-hidden="true">#</a></h3><ul><li>Standard Analyzer \uFF1A \u8FD9\u4E2A\u662F\u9ED8\u8BA4\u7684\u5206\u8BCD\u5668\uFF0C\u4F7F\u7528 Unicode \u6587\u672C\u5206\u5272\u7B97\u6CD5\uFF0C\u5C06\u6587\u672C\u6309\u5355\u8BCD\u5207\u5206\u5E76\u4E14\u8F6C\u4E3A\u5C0F\u5199</li><li>Simple Analyzer \uFF1A \u6309\u7167\u975E\u5B57\u6BCD\u5207\u5206\u5E76\u4E14\u8FDB\u884C\u5C0F\u5199\u5904\u7406</li><li>Stop Analyzer \uFF1A \u4E0E Simple Analyzer \u7C7B\u4F3C\uFF0C\u4F46\u589E\u52A0\u4E86\u505C\u7528\u8BCD\u8FC7\u6EE4\uFF08\u5982 a\u3001an\u3001and\u3001are\u3001as\u3001at\u3001be\u3001but \u7B49\uFF09</li><li>Whitespace Analyzer \uFF1A \u4F7F\u7528\u7A7A\u683C\u5BF9\u6587\u672C\u8FDB\u884C\u5207\u5206\uFF0C\u5E76\u4E0D\u8FDB\u884C\u5C0F\u5199\u8F6C\u6362</li><li>Patter n Analyzer \uFF1A \u4F7F\u7528\u6B63\u5219\u8868\u8FBE\u5F0F\u5207\u5206\uFF0C\u9ED8\u8BA4\u4F7F\u7528 \\W+ (\u975E\u5B57\u7B26\u5206\u9694)\u3002\u652F\u6301\u5C0F\u5199\u8F6C\u6362\u548C\u505C\u7528\u8BCD\u5220\u9664</li><li>keyword Analyzer \uFF1A \u4E0D\u8FDB\u884C\u5206\u8BCD</li><li>Language Analyzer \uFF1A \u63D0\u4F9B\u4E86\u591A\u79CD\u5E38\u89C1\u8BED\u8A00\u7684\u5206\u8BCD\u5668\u3002\u5982 Irish\u3001Italian\u3001Latvian \u7B49</li><li>Customer Analyzer\uFF1A\u81EA\u5B9A\u4E49\u5206\u8BCD\u5668</li></ul><h3 id="ik-\u5206\u8BCD\u5668" tabindex="-1">IK \u5206\u8BCD\u5668 <a class="header-anchor" href="#ik-\u5206\u8BCD\u5668" aria-hidden="true">#</a></h3><p>IK \u7684\u7B97\u6CD5\u662F\u57FA\u4E8E\u8BCD\u5178\u7684\uFF0C\u5176\u652F\u6301\u81EA\u5B9A\u4E49\u8BCD\u5178\u548C\u8BCD\u5178\u70ED\u66F4\u65B0\u3002IK \u5206\u8BCD\u5668\u63D2\u4EF6\u4E00\u5B9A\u8981\u548Ces\u7684\u7248\u672C\u76F8\u5BF9\u5E94\uFF0C\u5177\u4F53\u5B89\u88C5\u53C2\u8003 <a href="https://github.com/infinilabs/analysis-ik" target="_blank" rel="noopener noreferrer">https://github.com/infinilabs/analysis-ik</a></p><p>IK \u6709\u4E24\u79CD\u6A21\u5F0F\uFF1Aik_max_word \u548C ik_smart</p><ul><li>ik_max_word\uFF1A \u4F1A\u5C06\u6587\u672C\u505A\u6700\u7EC6\u7C92\u5EA6\u7684\u62C6\u5206\uFF0C\u6BD4\u5982\u4F1A\u5C06\u201C\u4E2D\u534E\u4EBA\u6C11\u5171\u548C\u56FD\u56FD\u6B4C\u201D\u62C6\u5206\u4E3A\u201C\u4E2D\u534E\u4EBA\u6C11\u5171\u548C\u56FD\u3001\u4E2D\u534E\u4EBA\u6C11\u3001\u4E2D\u534E\u3001\u534E\u4EBA\u3001\u4EBA\u6C11\u5171\u548C\u56FD\u3001\u4EBA\u6C11\u3001\u4EBA\u3001\u6C11\u3001\u5171\u548C\u56FD\u3001\u5171\u548C\u3001\u548C\u3001\u56FD\u56FD\u3001\u56FD\u6B4C\u201D\uFF0C\u4F1A\u7A77\u5C3D\u5404\u79CD\u53EF\u80FD\u7684\u7EC4\u5408</li><li>ik_smart\uFF1A \u4F1A\u505A\u6700\u7C97\u7C92\u5EA6\u7684\u62C6\u5206\uFF0C\u6BD4\u5982\u4F1A\u5C06\u201C\u4E2D\u534E\u4EBA\u6C11\u5171\u548C\u56FD\u56FD\u6B4C\u201D\u62C6\u5206\u4E3A\u201C\u4E2D\u534E\u4EBA\u6C11\u5171\u548C\u56FD\u3001\u56FD\u6B4C\u201D\uFF0C\u9002\u5408 Phrase \u67E5\u8BE2</li></ul><h3 id="\u6D4B\u8BD5\u5206\u8BCD\u5668" tabindex="-1">\u6D4B\u8BD5\u5206\u8BCD\u5668 <a class="header-anchor" href="#\u6D4B\u8BD5\u5206\u8BCD\u5668" aria-hidden="true">#</a></h3><div class="language-"><pre><code>POST _analyze
{  
    &quot;analyzer&quot;: &quot;ik_max_word&quot;,
    &quot;text&quot;: &quot;Linus \u572890\u5E74\u4EE3\u5F00\u53D1\u51FA\u4E86linux\u64CD\u4F5C\u7CFB\u7EDF&quot;  
}

POST _analyze
{  
    &quot;analyzer&quot;: &quot;ik_smart&quot;,
    &quot;text&quot;: &quot;Linus \u572890\u5E74\u4EE3\u5F00\u53D1\u51FA\u4E86linux\u64CD\u4F5C\u7CFB\u7EDF&quot;  
}
</code></pre></div><h3 id="\u521B\u5EFA\u7D22\u5F15\u6267\u884C\u5206\u8BCD\u5668" tabindex="-1">\u521B\u5EFA\u7D22\u5F15\u6267\u884C\u5206\u8BCD\u5668 <a class="header-anchor" href="#\u521B\u5EFA\u7D22\u5F15\u6267\u884C\u5206\u8BCD\u5668" aria-hidden="true">#</a></h3><div class="language-"><pre><code>{
\xA0\xA0&quot;mappings&quot;:\xA0{
\xA0\xA0\xA0\xA0&quot;properties&quot;:\xA0{
\xA0\xA0\xA0\xA0\xA0\xA0&quot;title&quot;:\xA0{
\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0&quot;type&quot;:\xA0&quot;text&quot;,
\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0&quot;analyzer&quot;:\xA0&quot;ik_max_word&quot;
\xA0\xA0\xA0\xA0\xA0\xA0}
\xA0\xA0\xA0\xA0}
\xA0\xA0}
}
</code></pre></div><h3 id="\u5206\u8BCD\u5DE5\u4F5C\u6D41\u7A0B" tabindex="-1">\u5206\u8BCD\u5DE5\u4F5C\u6D41\u7A0B <a class="header-anchor" href="#\u5206\u8BCD\u5DE5\u4F5C\u6D41\u7A0B" aria-hidden="true">#</a></h3><p><img src="`+r+`" alt=""></p><ul><li>character filters: \u5BF9\u8F93\u5165\u8FDB\u884C\u9884\u5904\u7406\uFF0C\u6BD4\u5982\u5220\u9664 html \u5143\u7D20\u3001\u5C06\u8868\u60C5\u7B26\u53F7\u6620\u5C04\u4E3A\u6587\u672C</li><li>tokenizer: \u6309\u7167\u6307\u5B9A\u7684\u89C4\u5219\u5BF9\u6587\u672C\u8FDB\u884C\u5207\u5206\uFF0C\u6BD4\u5982\u6309\u7A7A\u683C\u6765\u5207\u5206\u5355\u8BCD\uFF0C\u540C\u65F6\u4E5F\u8D1F\u8D23\u6807\u8BB0\u51FA\u6BCF\u4E2A\u5355\u8BCD\u7684\u987A\u5E8F\u3001\u4F4D\u7F6E\u4EE5\u53CA\u5355\u8BCD\u5728\u539F\u6587\u672C\u4E2D\u5F00\u59CB\u548C\u7ED3\u675F\u7684\u504F\u79FB\u91CF</li><li>token filters: \u5BF9\u5207\u5206\u540E\u7684\u5355\u8BCD\u8FDB\u884C\u5904\u7406\uFF0C\u5982\u8F6C\u6362\u4E3A\u5C0F\u5199\u3001\u5220\u9664\u505C\u7528\u8BCD\u3001\u589E\u52A0\u540C\u4E49\u8BCD\u3001\u8BCD\u5E72\u5316\u7B49\u3002\u4F8B\u5982\u8F93\u5165\xA0Is this d\xE9ja vu, \u5982\u679C\u6309\u7167\u7A7A\u683C\u5206\u8BCD\u7684\u8BDD\uFF0C\u4F1A\u88AB\u5206\u4E3A\xA0Is,\xA0this,\xA0d\xE9ja,\xA0vu\u3002\u6211\u4EEC\u53EF\u4EE5\u8BBE\u7F6E\xA0asciifolding\xA0token filters, \u5C06\xA0d\xE9ja, \u8F6C\u6362\u4E3A\xA0deja\uFF0Clowercase\u5C06\u5927\u5199\u8F6C\u6362\u4E3A\u5C0F\u5199</li></ul><div class="language-"><pre><code>{
  &quot;char_filter&quot;: [&quot;html_strip&quot;,
    {
      &quot;type&quot;: &quot;mapping&quot;,
      &quot;mappings&quot;: [
        &quot;\u{1F60A} =&gt; happy&quot;
      ]
    }
  ],
  &quot;tokenizer&quot;: {
    &quot;type&quot;: &quot;standard&quot;
  },
  &quot;filter&quot;: [],
  &quot;text&quot;: [
    &quot;Tom &amp;amp; Jerrey &amp;lt; &lt;b&gt;world&lt;/b&gt; \u{1F60A}&quot;
  ]
}

{
  &quot;mappings&quot;: {
    &quot;properties&quot;: {
      &quot;my_text&quot;: {
        &quot;type&quot;: &quot;text&quot;,
        &quot;analyzer&quot;: &quot;my_analyzer&quot;
      }
    }
  },
  &quot;settings&quot;: {
    &quot;analysis&quot;: {
      &quot;analyzer&quot;: {
        &quot;my_analyzer&quot;: {
          &quot;type&quot;: &quot;custom&quot;,
          &quot;char_filter&quot;: [
            &quot;html_strip&quot;,
            &quot;emo_to_word&quot;
          ],
          &quot;tokenizer&quot;: &quot;standard&quot;,
          &quot;filter&quot;: [
            &quot;lowercase&quot;
          ]
        }
      },
      &quot;char_filter&quot;: {
        &quot;emo_to_word&quot;: {
          &quot;type&quot;: &quot;mapping&quot;,
          &quot;mappings&quot;: [
            &quot;\u{1F60A} =&gt; happy&quot;
          ]
        }
      }
    }
  }
}
</code></pre></div><h2 id="\u4EC0\u4E48\u662F\u5012\u6392\u7D22\u5F15" tabindex="-1">\u4EC0\u4E48\u662F\u5012\u6392\u7D22\u5F15 <a class="header-anchor" href="#\u4EC0\u4E48\u662F\u5012\u6392\u7D22\u5F15" aria-hidden="true">#</a></h2><p>\u5012\u6392\u7D22\u5F15\u6307\u7684\u662F\u5C06\u6BCF\u4E00\u4E2A\u5173\u952E\u5B57\u6620\u5C04\u5230\u5B83\u51FA\u73B0\u7684\u6587\u6863\u4E2D\u3002\u5982\u4E0B\u56FE\u6240\u793A</p><p><img src="`+i+'" alt=""></p><h3 id="\u5012\u6392\u7D22\u5F15\u6570\u636E\u7ED3\u6784" tabindex="-1">\u5012\u6392\u7D22\u5F15\u6570\u636E\u7ED3\u6784 <a class="header-anchor" href="#\u5012\u6392\u7D22\u5F15\u6570\u636E\u7ED3\u6784" aria-hidden="true">#</a></h3><p>\u5012\u6392\u7D22\u5F15\u5206\u4E3A 2 \u90E8\u5206\uFF1A\u4E00\u90E8\u5206\u53EB term directory(term \u8BCD\u5178)\uFF0C\u4E00\u90E8\u5206\u53EB posting list(\u5012\u6392\u5217\u8868)\u3002\u5982\u4E0B\u56FE\u6240\u793A</p><p><img src="'+l+'" alt=""></p><ul><li>term directory\uFF0Cterm \u5B57\u5178\uFF0C\u5B58\u653E\u7740\u6BCF\u4E2A\u5355\u8BCD\u5230\u5BF9\u5E94\u5012\u6392\u5217\u8868\u7684\u6620\u5C04\u5173\u7CFB</li><li>posting list\uFF0CDocs \u662F\u4E00\u4E2A\u6570\u7EC4\u3002\u5176\u4E2D 1:2:[2,6] \u610F\u601D\u5982\u4E0B <ul><li>1\uFF1A\u6587\u6863ID</li><li>2\uFF1A\u8BCD\u9891(term frequency)</li><li>[2,6]\uFF1A\u51FA\u73B0\u5728\u6587\u6863\u4E2D\u7684\u7B2C 2\uFF0C6 \u4E2A term</li></ul></li></ul><h3 id="\u5012\u6392\u7D22\u5F15\u7684\u751F\u6210" tabindex="-1">\u5012\u6392\u7D22\u5F15\u7684\u751F\u6210 <a class="header-anchor" href="#\u5012\u6392\u7D22\u5F15\u7684\u751F\u6210" aria-hidden="true">#</a></h3><p>\u8FD9\u91CC\u6D89\u53CA\u5230\u6211\u4EEC\u4E4B\u524D\u8BB2\u8FC7\u7684\u5206\u8BCD\u5668\u3002\u5DE5\u4F5C\u6D41\u7A0B\u5982\u4E0B\u56FE\u6240\u793A</p><p><img src="'+s+'" alt=""></p><p>\u5927\u4F53\u5C31\u5305\u542B2\u90E8\u5206\uFF0C\u6839\u636E\u5206\u8BCD\u5668\u5C06\u6587\u672C\u5206\u8BCD\uFF0C\u7136\u540E\u6839\u636E\u5206\u8BCD\u751F\u6210\u5012\u6392\u7D22\u5F15\u3002</p><h3 id="\u67E5\u8BE2" tabindex="-1">\u67E5\u8BE2 <a class="header-anchor" href="#\u67E5\u8BE2" aria-hidden="true">#</a></h3><p>\u4F8B\u5982\u6211\u4EEC\u67E5\u8BE2\uFF1ATo do right \u5219\u8BE5\u6587\u672C\u4F1A\u5148\u88AB\u5206\u8BCD\u4E3A\uFF1Ato, do, right \u5BF9\u5E94\u7684\u7ED3\u679C\u5982\u4E0B\u56FE\u6240\u793A\uFF1A</p><p><img src="'+d+`" alt=""></p><h3 id="tf\u3001idf" tabindex="-1">TF\u3001IDF <a class="header-anchor" href="#tf\u3001idf" aria-hidden="true">#</a></h3><p>\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0CES \u4F1A\u6839\u636E\u6587\u6863\u4E0E\u641C\u7D22\u8BCD\u7684\u76F8\u5173\u6027\u5F97\u5206\u5BF9\u7ED3\u679C\u964D\u5E8F\u8FD4\u56DE\u3002\u76F8\u5173\u6027\u5F97\u5206\u4E0E\u4EE5\u4E0B 2 \u4E2A\u6982\u5FF5\u6709\u5173</p><ul><li>Term Frequency(TF)\uFF1Aterm \u5728\u6587\u6863\u4E2D\u51FA\u73B0\u7684\u9891\u7387\uFF0C\u5F97\u5206\u6B63\u76F8\u5173\u3002\u51FA\u73B0\u9891\u7387\u8D8A\u9AD8\uFF0C\u5F97\u5206\u8D8A\u9AD8</li><li>Inverted Document Frequency(IDF)\uFF1Aterm \u5728 \u6240\u6709\u6587\u6863 \u4E2D\u51FA\u73B0\u7684\u9891\u7387\uFF0C\u5F97\u5206\u8D1F\u76F8\u5173\u3002\u51FA\u73B0\u9891\u7387\u8D8A\u9AD8\uFF0C\u5F97\u5206\u8D8A\u4F4E</li></ul><p>ES5\u4E4B\u524D\u9ED8\u8BA4\u7684\u7B97\u5206\u91C7\u7528TF-IDF\uFF0CES5\u4E4B\u540E\u91C7\u7528BM25</p><p>BM25\u662F\u5728TF-DF\u57FA\u7840\u4E0A\u505A\u4E86\u4E00\u4E2A\u6536\u655B\uFF0C\u907F\u514D\u4E86TF\u65E0\u9650\u589E\u957F\u65F6\u5F97\u5206\u65E0\u9650\u589E\u957F\u7684\u95EE\u9898</p><h2 id="\u641C\u7D22\u8BED\u6CD5" tabindex="-1">\u641C\u7D22\u8BED\u6CD5 <a class="header-anchor" href="#\u641C\u7D22\u8BED\u6CD5" aria-hidden="true">#</a></h2><h3 id="match-all-\u67E5\u8BE2\u6240\u6709\u6587\u6863" tabindex="-1">match_all \u67E5\u8BE2\u6240\u6709\u6587\u6863 <a class="header-anchor" href="#match-all-\u67E5\u8BE2\u6240\u6709\u6587\u6863" aria-hidden="true">#</a></h3><div class="language-"><pre><code>{
  &quot;query&quot;: {
    &quot;match_all&quot;: {}
  }
}
</code></pre></div><h3 id="match-\u5355\u4E2A\u5B57\u6BB5\u5339\u914D" tabindex="-1">match \u5355\u4E2A\u5B57\u6BB5\u5339\u914D <a class="header-anchor" href="#match-\u5355\u4E2A\u5B57\u6BB5\u5339\u914D" aria-hidden="true">#</a></h3><p>\u5355\u4E2A\u5B57\u6BB5\u7684\u67E5\u8BE2\uFF0C\u5148\u5BF9\u641C\u7D22\u8BCD\u8FDB\u884C\u5206\u8BCD\uFF0C\u7136\u540E\u518D\u641C\u7D22\u3002</p><p>keyword\uFF1A\u4E0D\u5206\u8BCD\u7CBE\u786E\u5339\u914D</p><p>text\uFF1A\u5206\u8BCD\u540E\u5339\u914D</p><div class="language-"><pre><code>{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;title&quot;: &quot;\u6570\u636E\u5E93&quot;, # text\u7684\u4F1A\u5339\u914D&quot;\u6570\u636E\u5E93&quot;\u3001&quot;\u6570\u636E&quot;...
    }
  }
}
</code></pre></div><h3 id="multi-match-\u591A\u5B57\u6BB5\u5339\u914D" tabindex="-1">multi_match \u591A\u5B57\u6BB5\u5339\u914D <a class="header-anchor" href="#multi-match-\u591A\u5B57\u6BB5\u5339\u914D" aria-hidden="true">#</a></h3><p>\u4E3A\u80FD\u5728\u591A\u4E2A\u5B57\u6BB5\u4E0A\u53CD\u590D\u6267\u884C\u76F8\u540C\u67E5\u8BE2\u63D0\u4F9B\u4E86\u4E00\u79CD\u4FBF\u6377\u65B9\u5F0F</p><p>keyword\uFF1A\u4E0D\u5206\u8BCD\u7CBE\u786E\u5339\u914D</p><p>text\uFF1A\u5206\u8BCD\u5339\u914D</p><p>Type:</p><ul><li>\u6700\u4F73\u5B57\u6BB5\uFF08best_fields\uFF09\uFF1A\u53D6fields\u4E2D\u5206\u6570\u6700\u9AD8\u7684\uFF0C\u4FA7\u91CD\u4E8E\u5B57\u6BB5\u7EF4\u5EA6\uFF0C\u5355\u4E2A\u5B57\u6BB5\u7684\u5F97\u5206\u6743\u91CD\u5927\uFF0C\u5BF9\u4E8E\u540C\u4E00\u4E2Aquery\uFF0C\u5355\u4E2Afield\u5339\u914D\u66F4\u591A\u7684term\uFF0C\u5219\u4F18\u5148\u6392\u5E8F\u3002</li><li>\u6DF7\u5408\u5B57\u6BB5\uFF08cross_fields\uFF09\uFF1A\u7C7B\u4F3C\u4E8Ecopy_to\uFF0C\u5C31\u662F\u7C7B\u4F3C\u4E8E\u628A\u6240\u6709\u5B57\u6BB5\u6587\u5B57\u90FD\u62FC\u63A5\u8D77\u6765\uFF0C\u7136\u540E\u7B97\u8BC4\u5206</li></ul><div class="language-"><pre><code>{
  &quot;query&quot;: {
    &quot;multi_match&quot;: {
      &quot;type&quot;: &quot;best_fields&quot;, # \u53D6fields\u4E2D\u6700\u9AD8\u7684\u8BC4\u5206
      &quot;query&quot;: &quot;\u6570\u636E\u5E93&quot;,
      &quot;fields&quot;: [&quot;title&quot;,&quot;content&quot;]
    }
  }
}


{
  &quot;query&quot;: {
    &quot;multi_match&quot;: {
      &quot;type&quot;: &quot;cross_fields&quot;, # fields\u4E2D\u5B57\u6BB5\u5168\u90E8\u62FC\u63A5\u5230\u4E00\u8D77\u7B97\u5206
      &quot;operator&quot;: &quot;and&quot;
      &quot;query&quot;: &quot;\u6570\u636E\u5E93&quot;,
      &quot;fields&quot;: [&quot;title^5&quot;,&quot;content&quot;], # \u4E0Ecopy_to\u76F8\u6BD4\uFF0C\u5176\u4F18\u52BF\u662F\u53EF\u4EE5\u5728\u641C\u7D22\u65F6\u4E3A\u5355\u4E2A\u5B57\u6BB5\u63D0\u5347\u6743\u91CD
    }
  }
}
</code></pre></div><h3 id="match-phrase-\u77ED\u8BED\u5339\u914D" tabindex="-1">match_phrase \u77ED\u8BED\u5339\u914D <a class="header-anchor" href="#match-phrase-\u77ED\u8BED\u5339\u914D" aria-hidden="true">#</a></h3><p>\u77ED\u8BED\u5339\u914D\u67E5\u8BE2\uFF0Cslop\u8868\u793A\u5206\u8BCD\u7684\u8DE8\u5EA6\uFF0C\u6307\u5206\u8BCD\u548C\u5206\u8BCD\u4E4B\u95F4\u53EF\u4EE5\u76F8\u9694\u591A\u5C11\u4E2A\u8BCD\uFF0C\u7F3A\u5931\u4E86\u8FD9\u4E9B\u8BCD\u4ECD\u7136\u53EF\u4EE5\u67E5\u5230\u7ED3\u679C</p><div class="language-"><pre><code>{
  &quot;query&quot;: {
    &quot;match_phrase&quot;: {
      &quot;title&quot;: {
        &quot;query&quot;: &quot;\u6570\u636E\u5E93&quot;,
        &quot;slop&quot;: 4
      }
    }
  }
}
</code></pre></div><h3 id="term-\u5355\u503C\u7CBE\u786E\u67E5\u8BE2" tabindex="-1">term \u5355\u503C\u7CBE\u786E\u67E5\u8BE2 <a class="header-anchor" href="#term-\u5355\u503C\u7CBE\u786E\u67E5\u8BE2" aria-hidden="true">#</a></h3><p>\u5355\u4E2A\u5B57\u6BB5\u7684\u7CBE\u786E\u67E5\u8BE2</p><p>keyword\uFF1A\u4E0D\u5206\u8BCD\u7CBE\u786E\u5339\u914D</p><p>text\uFF1A\u4E0D\u5206\u8BCD\u5339\u914D</p><p>\u5982\u679C\u662Fkeyword\u7C7B\u578B\u67E5\u8BE2\u7684\u65F6\u5019\uFF0C\u4E0D\u9700\u8981\u6307\u5B9Akeyword\u5173\u952E\u5B57\u3002\u5982\u679C\u662Ftext\u7C7B\u578B\u7684\u5728\u5168\u5339\u914D\u7684\u65F6\u5019\u9700\u8981\u6307\u5B9Akeyword\u5173\u952E\u5B57</p><div class="language-"><pre><code>{
  &quot;query&quot;: {
    &quot;term&quot;: {
      &quot;title&quot;: &quot;\u7EA2\u697C\u68A6&quot;
    }
  }
}

{
  &quot;query&quot;: {
    &quot;term&quot;: {
      &quot;content.keyword&quot;: &quot;\u5F53\u65F6\u793E\u4F1A\u7684\u9636\u7EA7\u5173\u7CFB\u548C\u6743\u529B\u7ED3\u6784&quot;
    }
  }
}

# \u5927\u5C0F\u5199\u4E0D\u654F\u611F\u67E5\u8BE2
{
  &quot;query&quot;: {
    &quot;term&quot;: {
      &quot;title&quot;: {
        &quot;value&quot;: &quot;Romeo&quot;,
        &quot;case_insensitive&quot;: true
      }
    }
  }
}
</code></pre></div><h3 id="terms-\u591A\u503C\u7CBE\u786E\u5339\u914D" tabindex="-1">terms \u591A\u503C\u7CBE\u786E\u5339\u914D <a class="header-anchor" href="#terms-\u591A\u503C\u7CBE\u786E\u5339\u914D" aria-hidden="true">#</a></h3><p>\u7CBE\u786E\u5339\u914D\u591A\u4E2A\u503C\uFF0C\u53EA\u8981\u88AB\u67E5\u5B57\u6BB5\u5305\u542B\u6307\u5B9A\u6570\u7EC4\u4E2D\u4EFB\u4F55\u4E00\u4E2A\u503C\u5C31\u7B97\u7B26\u5408\u6761\u4EF6\uFF0C\u4E0D\u80FD\u8BBE\u7F6E\u5927\u5C0F\u5199\u654F\u611F\uFF0C \u5982\u679C\u9700\u8981\u5927\u5C0F\u5199\u4E0D\u654F\u611F\u9700\u8981\u5728\u521B\u5EFA\u7D22\u5F15\u65F6\u6307\u5B9A</p><div class="language-"><pre><code>{
  &quot;query&quot;: {
    &quot;terms&quot;: {
      &quot;title&quot;: [&quot;\u7EA2\u697C\u68A6&quot;,&quot;\u897F\u6E38\u8BB0&quot;]
    }
  }
}
</code></pre></div><h3 id="prefix-\u524D\u7F00\u5339\u914D" tabindex="-1">prefix \u524D\u7F00\u5339\u914D <a class="header-anchor" href="#prefix-\u524D\u7F00\u5339\u914D" aria-hidden="true">#</a></h3><p>\u5339\u914D\u7B26\u5408\u524D\u7F00\u8981\u6C42\u7684\u5012\u6392\u7D22\u5F15\u6570\u636E\u3002</p><p>\u6CE8\u610F\uFF1A\u9700\u8981\u533A\u5206\u5927\u5C0F\u5199\uFF0C\u641C\u7D22\u8BCD\u8981\u662F\u5C0F\u5199\uFF08\u6216\u8005\u5B9A\u4E49mapping\u548Csettings\u7684\u65F6\u5019\u7ED9\u8FD9\u4E2A\u5B57\u6BB5\u8BBE\u7F6E\u5FFD\u7565\u5927\u5C0F\u5199\uFF09\uFF0C\u56E0\u4E3A\u6587\u6863\u7684\u8BCD\u90FD\u662F\u5C0F\u5199\u7684</p><div class="language-"><pre><code>{
  &quot;query&quot;: {
    &quot;prefix&quot;:{
      &quot;title&quot;:&quot;rom&quot;
    }
  }
}
</code></pre></div><h3 id="wildcard-\u901A\u914D\u7B26\u5339\u914D" tabindex="-1">wildcard \u901A\u914D\u7B26\u5339\u914D <a class="header-anchor" href="#wildcard-\u901A\u914D\u7B26\u5339\u914D" aria-hidden="true">#</a></h3><p>\u901A\u914D\u7B26\uFF08*\u8868\u793A\u4EFB\u4F55\u5B57\u7B26\u4E32\uFF0C?\u8868\u793A\u4EFB\u4F55\u5355\u4E2A\u5B57\u7B26\uFF09\u5339\u914D\u5012\u6392\u7D22\u5F15</p><p>\u6CE8\u610F\uFF1A\u9700\u8981\u533A\u5206\u5927\u5C0F\u5199\uFF0C\u641C\u7D22\u8BCD\u8981\u662F\u5C0F\u5199\uFF08\u6216\u8005\u5B9A\u4E49mapping\u548Csettings\u7684\u65F6\u5019\u7ED9\u8FD9\u4E2A\u5B57\u6BB5\u8BBE\u7F6E\u5FFD\u7565\u5927\u5C0F\u5199\uFF09\uFF0C\u56E0\u4E3A\u6587\u6863\u7684\u8BCD\u90FD\u662F\u5C0F\u5199\u7684</p><div class="language-"><pre><code>{
  &quot;query&quot;: {
    &quot;wildcard&quot;: {
      &quot;title&quot;: &quot;ro*&quot;
    }
  }
}
</code></pre></div><h3 id="regexp-\u6B63\u5219\u5339\u914D" tabindex="-1">regexp \u6B63\u5219\u5339\u914D <a class="header-anchor" href="#regexp-\u6B63\u5219\u5339\u914D" aria-hidden="true">#</a></h3><p>\u6B63\u5219\u8868\u8FBE\u5F0F\u5339\u914D\u5012\u6392\u7D22\u5F15</p><p>\u6CE8\u610F\uFF1A\u9700\u8981\u533A\u5206\u5927\u5C0F\u5199\uFF0C\u641C\u7D22\u8BCD\u8981\u662F\u5C0F\u5199\uFF08\u6216\u8005\u5B9A\u4E49mapping\u548Csettings\u7684\u65F6\u5019\u7ED9\u8FD9\u4E2A\u5B57\u6BB5\u8BBE\u7F6E\u5FFD\u7565\u5927\u5C0F\u5199\uFF09\uFF0C\u56E0\u4E3A\u6587\u6863\u7684\u8BCD\u90FD\u662F\u5C0F\u5199\u7684</p><div class="language-"><pre><code>{
  &quot;query&quot;: {
    &quot;regexp&quot;: {
      &quot;title&quot;: &quot;.*iet&quot;
    }
  }
}
</code></pre></div><h3 id="fuzzy-\u8FD1\u4F3C\u5339\u914D" tabindex="-1">fuzzy \u8FD1\u4F3C\u5339\u914D <a class="header-anchor" href="#fuzzy-\u8FD1\u4F3C\u5339\u914D" aria-hidden="true">#</a></h3><p>fuzziness\u7528\u4E8E\u63A7\u5236levenshtein\u8DDD\u79BB\uFF0C\u533A\u5206\u5927\u5C0F\u5199</p><div class="language-"><pre><code>{
  &quot;query&quot;: {
    &quot;fuzzy&quot;: {
      &quot;author&quot;: {
        &quot;value&quot;: &quot;Shakespea&quot;,
        &quot;fuzziness&quot;: 2
      }
    }
  }
}
</code></pre></div><h3 id="range-\u533A\u95F4\u5339\u914D" tabindex="-1">range \u533A\u95F4\u5339\u914D <a class="header-anchor" href="#range-\u533A\u95F4\u5339\u914D" aria-hidden="true">#</a></h3><p>\u533A\u95F4\u5339\u914D\uFF0C</p><p>\u53EF\u4EE5\u4F7F\u7528\uFF1Agt\uFF08\u5927\u4E8E\uFF09\u3001gte\uFF08\u5927\u4E8E\u7B49\u4E8E\uFF09\u3001lt\uFF08\u5C0F\u4E8E\uFF09\u3001lte\uFF08\u5C0F\u4E8E\u7B49\u4E8E\uFF09</p><div class="language-"><pre><code>{
  &quot;query&quot;: {
    &quot;range&quot;: {
      &quot;count&quot;: {
        &quot;gte&quot;: 30,
        &quot;lte&quot;: 70
      }
    }
  }
}
</code></pre></div><h3 id="exists-\u5339\u914D\u6307\u5B9A\u5B57\u6BB5\u975E\u7A7A\u7684\u6587\u6863" tabindex="-1">exists \u5339\u914D\u6307\u5B9A\u5B57\u6BB5\u975E\u7A7A\u7684\u6587\u6863 <a class="header-anchor" href="#exists-\u5339\u914D\u6307\u5B9A\u5B57\u6BB5\u975E\u7A7A\u7684\u6587\u6863" aria-hidden="true">#</a></h3><p>\u67E5\u8BE2\u6307\u5B9A\u5B57\u6BB5\u503C\u4E0D\u4E3Anull\u7684\u6570\u636E\uFF0C\u7528\u4E8E\u628A\u67D0\u4E2A\u5B57\u6BB5\u4E0D\u4E3Anull\u7684\u6587\u6863\u5F80\u524D\u6392</p><div class="language-"><pre><code>{
  &quot;query&quot;: {
    &quot;exists&quot;: {
      &quot;field&quot;: &quot;title&quot;
    }
  }
}
</code></pre></div><h3 id="ids-id\u6570\u503C\u5339\u914D" tabindex="-1">ids id\u6570\u503C\u5339\u914D <a class="header-anchor" href="#ids-id\u6570\u503C\u5339\u914D" aria-hidden="true">#</a></h3><p>\u7528\u4E8E\u901A\u8FC7\u6587\u6863id\u6570\u7EC4\u5339\u914D\u6587\u6863</p><div class="language-"><pre><code>{
  &quot;query&quot;: {
    &quot;ids&quot;: {
      &quot;values&quot;: [1,3]
    }
  }
}
</code></pre></div><h3 id="term\u3001match-\u533A\u522B" tabindex="-1">term\u3001match \u533A\u522B <a class="header-anchor" href="#term\u3001match-\u533A\u522B" aria-hidden="true">#</a></h3><ul><li>term \u5B8C\u6574\u5339\u914D\u6574\u4E2A\u8F93\u5165\uFF0C\u6B63\u5E38 term \u7684\u67E5\u8BE2\u6027\u80FD\u4F1A\u4F18\u4E8E match</li><li>match \u5BF9\u8F93\u5165\u8FDB\u884C\u5206\u8BCD\uFF0C\u7136\u540E\u5339\u914D\u6BCF\u4E2A\u5206\u8BCD\uFF08\u9700\u8981\u6CE8\u610F\u7684\u662F\uFF0C\u5F53\u5728 keyword \u7C7B\u578B\u4E0B\u4F7F\u7528 match \u65F6\uFF0C\u4ED6\u7684\u8868\u73B0\u548C term \u4E00\u6837\uFF09</li></ul><h3 id="bool-\u5E03\u5C14\u67E5\u8BE2" tabindex="-1">bool \u5E03\u5C14\u67E5\u8BE2 <a class="header-anchor" href="#bool-\u5E03\u5C14\u67E5\u8BE2" aria-hidden="true">#</a></h3><p>bool\u67E5\u8BE2\u662F\u4E00\u4E2A\u6216\u8005\u591A\u4E2A\u67E5\u8BE2\u5B50\u53E5\u7684\u7EC4\u5408\uFF0C\u652F\u6301must \u3001must not\u3001should\u3001filter\u56DB\u79CD\u5B50\u53E5\u3002</p><ul><li>must \uFF1A\u5FC5\u987B\u5339\u914D\uFF0C\u53C2\u4E0E\u7B97\u5206</li><li>should \uFF1A\u9009\u62E9\u6027\u5339\u914D\u3001\u53C2\u4E0E\u7B97\u5206</li><li>must not\uFF1A\u5FC5\u987B\u4E0D\u5339\u914D\uFF0C\u4E0D\u53C2\u4E0E\u7B97\u5206</li><li>filter\uFF1A\u5FC5\u987B\u5339\u914D\uFF0C\u4E0D\u53C2\u4E0E\u7B97\u5206\uFF0C \u53EF\u4EE5\u4F7F\u7528\u7F13\u5B58</li></ul><p>bool\u5B50\u67E5\u8BE2\u53EF\u4EE5\u4EFB\u610F\u987A\u5E8F\u51FA\u73B0\u3001\u53EF\u4EE5\u540C\u65F6\u591A\u4E2A\u5B50\u67E5\u8BE2</p><p>should must\u8054\u7528\u95EE\u9898</p><div class="language-"><pre><code>{
  &quot;query&quot;: {
    &quot;bool&quot;: {
      &quot;must&quot;: {
        &quot;term&quot;: {&quot;gender&quot;: &quot;\u7537&quot;}
      },
      &quot;should&quot;: [
        {
          &quot;term&quot;: {&quot;score&quot;: 70}
        },
        {
          &quot;term&quot;: {&quot;score&quot;: 80}
        }
      ]
    }
  }
}

\u89E3\u51B3\u65B9\u6CD5

{
  &quot;query&quot;: {
    &quot;bool&quot;: {
      &quot;should&quot;: [
        {
          &quot;bool&quot;: {
            &quot;must&quot;: [
              {
                &quot;term&quot;: {&quot;gender&quot;: &quot;\u7537&quot;}
              },
              {
                &quot;term&quot;: {&quot;score&quot;: &quot;70&quot;}
              }
            ]
          }
        },
        {
          &quot;bool&quot;: {
            &quot;must&quot;: [
              {
                &quot;term&quot;: {&quot;gender&quot;: &quot;\u7537&quot;}
              },
              {
                &quot;term&quot;: {&quot;score&quot;: &quot;80&quot;}
              }
            ]
          }
        }
      ]
    }
  }
}

{
  &quot;query&quot;: {
    &quot;bool&quot;: {
      &quot;must&quot;: [
        {
          &quot;term&quot;: {&quot;gender&quot;: &quot;\u7537&quot;}
        },
        {
          &quot;bool&quot;: {
            &quot;should&quot;: [
              {
                &quot;term&quot;: {&quot;score&quot;: 70}
              },
              {
                &quot;term&quot;: {&quot;score&quot;: 80}
              }
            ]
          }
        }
      ]
    }
  }
}

</code></pre></div><p>\u5C3D\u91CF\u5728\u7B5B\u9009\u7684\u65F6\u5019\u591A\u4F7F\u7528\u4E0D\u53C2\u4E0E\u7B97\u5206\u7684must_not\u548Cfilter\uFF0C\u4EE5\u4FDD\u8BC1\u6027\u80FD\u826F\u597D</p><h3 id="query-string-\u5B57\u7B26\u4E32\u5339\u914D" tabindex="-1">query_string \u5B57\u7B26\u4E32\u5339\u914D <a class="header-anchor" href="#query-string-\u5B57\u7B26\u4E32\u5339\u914D" aria-hidden="true">#</a></h3><p>\u5B57\u7B26\u4E32\u7684\u4E13\u7528\u5339\u914D\uFF0C\u53EF\u4EE5\u591A\u4E2A\u6761\u4EF6\u3001\u591A\u4E2A\u5B57\u6BB5\u8FDB\u884C\u5339\u914D</p><ul><li>\u903B\u8F91\u8FD0\u7B97\u7B26\u5927\u5199AND\u3001OR\u3001NOT</li><li>\u9ED8\u8BA4\u4F1A\u5BF9\u5B57\u7B26\u4E32\u5206\u8BCD\uFF0C\u5982\u679C\u4E0D\u9700\u8981\u5206\u8BCD \u9700\u8981\u52A0\u4E0A\u201D\u201C</li><li>\u9ED8\u8BA4\u8FD0\u7B97\u7B26\u662FOR</li><li>\u4E25\u683C\u6309\u7167\u903B\u8F91\u5173\u7CFB\u52A0\u62EC\u53F7</li></ul><div class="language-"><pre><code>{
  &quot;query&quot;: {
    &quot;query_string&quot;: {
      &quot;query&quot;: &quot;(truth AND good) OR Romeo&quot;,
      &quot;fields&quot;: [&quot;title&quot;,&quot;content&quot;]
    }
  }
}
</code></pre></div><h2 id="\u5206\u9875" tabindex="-1">\u5206\u9875 <a class="header-anchor" href="#\u5206\u9875" aria-hidden="true">#</a></h2><p>ES \u63D0\u4F9B\u4E86 3 \u79CD\u5206\u9875\u65B9\u5F0F\uFF1A</p><ul><li>from + size\uFF1A\u6700\u666E\u901A\u3001\u7B80\u5355\u7684\u5206\u9875\u65B9\u5F0F\uFF0C\u4F46\u662F\u4F1A\u4EA7\u751F\u6DF1\u5206\u9875\u7684\u95EE\u9898</li><li>search after\uFF1A\u89E3\u51B3\u4E86\u6DF1\u5206\u9875\u7684\u95EE\u9898\uFF0C\u4F46\u53EA\u80FD\u4E00\u9875\u4E00\u9875\u5730\u5F80\u4E0B\u7FFB\uFF0C\u4E0D\u652F\u6301\u8DF3\u8F6C\u5230\u6307\u5B9A\u9875\u6570</li><li>scroll API/PIT\uFF1A\u4F1A\u521B\u5EFA\u6570\u636E\u5FEB\u7167\uFF0C\u65E0\u6CD5\u68C0\u7D22\u65B0\u5199\u5165\u7684\u6570\u636E\uFF0C\u9002\u5408\u5BF9\u7ED3\u679C\u96C6\u8FDB\u884C\u904D\u5386\u7684\u65F6\u5019\u4F7F\u7528</li></ul><h3 id="from-size-\u5206\u9875\u64CD\u4F5C\u4E0E\u6DF1\u5206\u9875\u95EE\u9898" tabindex="-1">from + size \u5206\u9875\u64CD\u4F5C\u4E0E\u6DF1\u5206\u9875\u95EE\u9898 <a class="header-anchor" href="#from-size-\u5206\u9875\u64CD\u4F5C\u4E0E\u6DF1\u5206\u9875\u95EE\u9898" aria-hidden="true">#</a></h3><p>\u5728\u6211\u4EEC\u68C0\u7D22\u6570\u636E\u65F6\uFF0C\u7CFB\u7EDF\u4F1A\u5BF9\u6570\u636E\u6309\u7167\u76F8\u5173\u6027\u7B97\u5206\u8FDB\u884C\u6392\u5E8F\uFF0C\u7136\u540E\u9ED8\u8BA4\u8FD4\u56DE\u524D 10 \u6761\u6570\u636E\u3002\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528 from + size \u6765\u6307\u5B9A\u83B7\u53D6\u54EA\u4E9B\u6570\u636E\u3002\u5176\u4F7F\u7528\u793A\u4F8B\u5982\u4E0B\uFF1A</p><div class="language-"><pre><code>{
  &quot;from&quot;: 0, # \u6307\u5B9A\u5F00\u59CB\u4F4D\u7F6E
  &quot;size&quot;: 10, # \u6307\u5B9A\u83B7\u53D6\u6587\u6863\u4E2A\u6570
  &quot;query&quot;: {
    &quot;match_all&quot;: {}
  }
}
</code></pre></div><p>\u5982\u4E0A\u793A\u4F8B\uFF0C\u4F7F\u7528 &quot;from&quot; \u6307\u5B9A\u83B7\u53D6\u6570\u636E\u7684\u5F00\u59CB\u4F4D\u7F6E\uFF0C\u4F7F\u7528 &quot;size&quot; \u6307\u5B9A\u83B7\u53D6\u6587\u6863\u7684\u4E2A\u6570\u3002</p><p>\u4F46\u5F53\u6211\u4EEC\u5C06 from \u8BBE\u7F6E\u5927\u4E8E 10000 \u6216\u8005 size \u8BBE\u7F6E\u5927\u4E8E 10001 \u7684\u65F6\u5019\uFF0C\u8FD9\u4E2A\u67E5\u8BE2\u5C06\u4F1A\u62A5\u9519\uFF1A</p><div class="language-"><pre><code># \u8FD4\u56DE\u7ED3\u679C\u4E2D\u7684\u90E8\u5206\u9519\u8BEF\u4FE1\u606F
......
&quot;root_cause&quot; : [
  {
    &quot;type&quot; : &quot;illegal_argument_exception&quot;,
    &quot;reason&quot; : &quot;Result window is too large, from + size must be less than or equal to: [10000] but was [10001]. See the scroll api for a more efficient way to request large data sets. This limit can be set by changing the [index.max_result_window] index level setting.&quot;
  }
],
&quot;type&quot; : &quot;search_phase_execution_exception&quot;,
&quot;reason&quot; : &quot;all shards failed&quot;,
&quot;phase&quot; : &quot;query&quot;,
&quot;grouped&quot; : true,
......
</code></pre></div><p>\u6570\u636E\u96C6\u5408\u592A\u5927\u4E86\uFF0C\u7CFB\u7EDF\u62D2\u7EDD\u4E86\u6211\u4EEC\u7684\u8BF7\u6C42\u3002\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528 &quot;index.max_result_window&quot; \u914D\u7F6E\u9879\u8BBE\u7F6E\u8FD9\u4E2A\u4E0A\u9650\uFF1A</p><div class="language-"><pre><code>PUT my_index/_settings
{
  &quot;index&quot;: {
    &quot;max_result_window&quot;: 20000
  }
}
</code></pre></div><p>\u8FD9\u4E2A\u914D\u7F6E\u6709\u65F6\u5019\u53EF\u4EE5\u89E3\u51B3\u71C3\u7709\u4E4B\u6025\uFF0C\u4F46\u662F\u8FD9\u4E2A\u4E0A\u9650\u8BBE\u7F6E\u8FC7\u5927\u7684\u60C5\u51B5\u4E0B\u4F1A\u4EA7\u751F\u975E\u5E38\u4E25\u91CD\u7684\u540E\u679C\u3002</p><p><img src="`+p+`" alt=""></p><p>\u5982\u4E0A\u56FE\uFF0CES\u628A\u6570\u636E\u4FDD\u5B58\u52303\u4E2A\u4E3B\u5206\u7247\u4E2D\uFF0C\u5F53\u4F7F\u7528from = 90\u548Csize = 10\u8FDB\u884C\u5206\u9875\u7684\u65F6\u5019\uFF0CES\u4F1A\u5148\u4ECE\u6BCF\u4E2A\u5206\u7247\u4E2D\u5206\u522B\u83B7\u53D6100\u4E2A\u6587\u6863\uFF0C\u7136\u540E\u628A\u8FD9300\u4E2A\u6587\u6863\u518D\u6C47\u805A\u5230\u534F\u8C03\u8282\u70B9\u4E2D\u8FDB\u884C\u6392\u5E8F\uFF0C\u6700\u540E\u9009\u51FA\u6392\u5E8F\u540E\u7684\u524D100\u4E2A\u6587\u6863\uFF0C\u8FD4\u56DE\u7B2C90\u523099\u7684\u6587\u6863\u3002</p><p>\u53EF\u4EE5\u770B\u5230\uFF0C\u5F53\u9875\u6570\u53D8\u5927\uFF08\u53D1\u751F\u4E86\u6DF1\u5206\u9875\uFF09\u7684\u65F6\u5019\uFF0C\u5728\u6BCF\u4E2A\u5206\u7247\u4E2D\u83B7\u53D6\u7684\u6570\u636E\u5C31\u8D8A\u591A\uFF0C\u6D88\u8017\u7684\u8D44\u6E90\u5C31\u8D8A\u591A\u3002\u5E76\u4E14\u5982\u679C\u5206\u7247\u8D8A\u591A\uFF0C\u6C47\u805A\u5230\u534F\u8C03\u8282\u70B9\u7684\u6570\u636E\u4E5F\u8D8A\u591A\uFF0C\u6700\u7EC8\u6C47\u805A\u5230\u534F\u8C03\u8282\u70B9\u7684\u6587\u6863\u6570\u4E3A\uFF1Ashard_amount * (from + size)\u3002</p><h3 id="search-after" tabindex="-1">search after <a class="header-anchor" href="#search-after" aria-hidden="true">#</a></h3><p>\u4F7F\u7528 search after API \u53EF\u4EE5\u907F\u514D\u4EA7\u751F\u6DF1\u5206\u9875\u7684\u95EE\u9898\uFF0C\u4E0D\u8FC7 search after \u4E0D\u652F\u6301\u8DF3\u8F6C\u5230\u6307\u5B9A\u9875\u6570\uFF0C\u53EA\u80FD\u4E00\u9875\u9875\u5730\u5F80\u4E0B\u7FFB\u3002</p><p>\u4F7F\u7528 search after \u63A5\u53E3\u5206\u4E3A\u4E24\u6B65\uFF1A</p><ul><li>\u5728 sort \u4E2D\u6307\u5B9A\u9700\u8981\u6392\u5E8F\u7684\u5B57\u6BB5\uFF0C\u5E76\u4E14\u4FDD\u8BC1\u5176\u503C\u7684\u552F\u4E00\u6027\uFF08\u53EF\u4EE5\u4F7F\u7528\u6587\u6863\u7684 ID\uFF09</li><li>\u5728\u4E0B\u4E00\u6B21\u67E5\u8BE2\u65F6\uFF0C\u5E26\u4E0A\u8FD4\u56DE\u7ED3\u679C\u4E2D\u6700\u540E\u4E00\u4E2A\u6587\u6863\u7684 sort \u503C\u8FDB\u884C\u8BBF\u95EE</li></ul><div class="language-"><pre><code># \u7B2C\u4E00\u6B21\u8C03\u7528 search after
POST my_index/_search
{
  &quot;size&quot;: 2,
  &quot;query&quot;: { &quot;match_all&quot;: {} },
  &quot;sort&quot;: [
    { &quot;_id&quot;: &quot;asc&quot; }
  ]
}

# \u8FD4\u56DE\u7ED3\u679C
&quot;hits&quot; : [
  {
    &quot;_id&quot; : &quot;1&quot;,
    &quot;_source&quot; : {
      &quot;book_id&quot; : &quot;4ee82467&quot;,
      &quot;price&quot; : 20.9
    },
    &quot;sort&quot; : [&quot;1&quot;]
  },
  {
    &quot;_id&quot; : &quot;2&quot;,
    &quot;_source&quot; : {
      &quot;book_id&quot; : &quot;4ee82462&quot;,
      &quot;price&quot; : 19.9
    },
    &quot;sort&quot; : [&quot;2&quot;]
  }
]

# \u7B2C\u4E8C\u6B21\u8C03\u7528 search after
POST books/_search
{
  &quot;size&quot;: 2,
  &quot;query&quot;: {
    &quot;match_all&quot;: {}
  },
  &quot;search_after&quot;:[&quot;2&quot;], # \u8BBE\u7F6E\u4E3A\u4E0A\u6B21\u8FD4\u56DE\u7ED3\u679C\u4E2D\u6700\u540E\u4E00\u4E2A\u6587\u6863\u7684 sort \u503C
  &quot;sort&quot;: [
    { &quot;_id&quot;: &quot;asc&quot; }
  ]
}
</code></pre></div><p>\u56E0\u4E3A\u6709\u4E86\u552F\u4E00\u7684\u6392\u5E8F\u503C\u505A\u4FDD\u8BC1\uFF0C\u6240\u4EE5\u6BCF\u4E2A\u5206\u7247\u53EA\u9700\u8981\u8FD4\u56DE\u6BD4 sort \u4E2D\u552F\u4E00\u503C\u5927\u7684 size \u4E2A\u6570\u636E\u5373\u53EF\u3002\u4F8B\u5982\uFF0C\u4E0A\u4E00\u6B21\u7684\u67E5\u8BE2\u8FD4\u56DE\u7684\u6700\u540E\u4E00\u4E2A\u6587\u6863\u7684 sort \u4E3A a\uFF0C\u90A3\u4E48\u8FD9\u4E00\u6B21\u67E5\u8BE2\u53EA\u9700\u8981\u5728\u5206\u7247 1\u30012\u30013 \u4E2D\u8FD4\u56DE size \u4E2A\u6392\u5E8F\u6BD4 a \u5927\u7684\u6587\u6863\uFF0C\u534F\u8C03\u8282\u70B9\u6C47\u603B\u8FD9\u4E9B\u6570\u636E\u8FDB\u884C\u6392\u5E8F\u540E\u8FD4\u56DE size \u4E2A\u7ED3\u679C\u7ED9\u5BA2\u6237\u7AEF\u3002</p><h3 id="scroll-api" tabindex="-1">scroll API <a class="header-anchor" href="#scroll-api" aria-hidden="true">#</a></h3><p>\u5F53\u6211\u4EEC\u60F3\u5BF9\u7ED3\u679C\u96C6\u8FDB\u884C\u904D\u5386\u7684\u65F6\u5019\uFF0C\u4F8B\u5982\u505A\u5168\u91CF\u6570\u636E\u5BFC\u51FA\u65F6\uFF0C\u53EF\u4EE5\u4F7F\u7528 scroll API\u3002scroll API \u4F1A\u521B\u5EFA\u6570\u636E\u5FEB\u7167\uFF0C\u540E\u7EED\u7684\u8BBF\u95EE\u5C06\u4F1A\u57FA\u4E8E\u8FD9\u4E2A\u5FEB\u7167\u6765\u8FDB\u884C\uFF0C\u6240\u4EE5\u65E0\u6CD5\u68C0\u7D22\u65B0\u5199\u5165\u7684\u6570\u636E\u3002</p><div class="language-"><pre><code># \u7B2C\u4E00\u6B21\u4F7F\u7528 scroll API
POST my_index/_search?scroll=10m
{
  &quot;query&quot;: {
    &quot;match_all&quot;: {}
  },
  &quot;sort&quot;: { &quot;price&quot;: &quot;desc&quot; }, 
  &quot;size&quot;: 2
}

# \u7ED3\u679C
{
  &quot;_scroll_id&quot; : &quot;FGluY2x1ZGVfY29udGV4dF9......==&quot;,
  &quot;hits&quot; : {
    &quot;hits&quot; : [
      {
        &quot;_id&quot; : &quot;6&quot;,
        &quot;_source&quot; : {
          &quot;book_id&quot; : &quot;4ee82467&quot;,
          &quot;price&quot; : 20.9
        }
      },
      ......
    ]
  }
}
</code></pre></div><p>\u5982\u4E0A\u793A\u4F8B\uFF0C\u5728\u7B2C\u4E00\u6B21\u4F7F\u7528 scroll API \u65F6\u9700\u8981\u521D\u59CB\u5316 scroll \u641C\u7D22\u5E76\u4E14\u521B\u5EFA\u5FEB\u7167\uFF0C\u4F7F\u7528 scroll \u67E5\u8BE2\u53C2\u6570\u6307\u5B9A\u672C\u6B21\u201C\u67E5\u8BE2\u4E0A\u4E0B\u6587\u201D\uFF08\u5FEB\u7167\uFF09\u7684\u6709\u6548\u65F6\u95F4\uFF0C\u672C\u793A\u4F8B\u4E2D\u4E3A 10 \u5206\u949F</p><div class="language-"><pre><code># \u8FDB\u884C\u7FFB\u9875
POST /_search/scroll                                                    
{
  &quot;scroll&quot; : &quot;5m&quot;,   
  &quot;scroll_id&quot; : &quot;FGluY2x1ZGVfY29udGV4dF9......==&quot; 
}
</code></pre></div><p>\u6211\u4EEC\u628A\u4E0A\u4E00\u6B21\u8FD4\u56DE\u7ED3\u679C\u4E2D\u7684 _scroll_id \u503C\u653E\u5230\u672C\u6B21\u8BF7\u6C42\u7684 scroll_id \u5B57\u6BB5\u4E2D\uFF0C\u5E76\u4E14\u6307\u5B9A\u201C\u67E5\u8BE2\u4E0A\u4E0B\u6587\u201D\u7684\u6709\u6548\u65F6\u95F4\u4E3A 5 \u5206\u949F\u3002\u540C\u6837\u6B64\u6B21\u7684\u8FD4\u56DE\u7ED3\u679C\u4E5F\u4F1A\u5E26\u6709\u65B0\u7684 _scroll_id\u3002</p><h4 id="scroll-\u95EE\u9898" tabindex="-1">scroll \u95EE\u9898 <a class="header-anchor" href="#scroll-\u95EE\u9898" aria-hidden="true">#</a></h4><p><a href="https://discuss.elastic.co/t/ridiculously-long-scroll-id/12913" target="_blank" rel="noopener noreferrer">https://discuss.elastic.co/t/ridiculously-long-scroll-id/12913</a></p><h3 id="pit" tabindex="-1">PIT <a class="header-anchor" href="#pit" aria-hidden="true">#</a></h3><p>ES 7.10 \u4E2D\u5F15\u5165\u4E86 Point In Time \u540E\uFF0Cscroll API \u5C31\u4E0D\u5EFA\u8BAE\u88AB\u4F7F\u7528\u4E86\u3002Point In Time\uFF08PIT\uFF09\u662F ES 7.10 \u4E2D\u5F15\u5165\u7684\u65B0\u7279\u6027\uFF0CPIT \u662F\u4E00\u4E2A\u8F7B\u91CF\u7EA7\u7684\u6570\u636E\u72B6\u6001\u89C6\u56FE\uFF0C\u7528\u6237\u53EF\u4EE5\u5229\u7528\u8FD9\u4E2A\u89C6\u56FE\u53CD\u590D\u67E5\u8BE2\u67D0\u4E2A\u7D22\u5F15\uFF0C\u4EFF\u4F5B\u8FD9\u4E2A\u7D22\u5F15\u7684\u6570\u636E\u96C6\u505C\u7559\u5728\u67D0\u4E2A\u65F6\u95F4\u70B9\u4E0A\u3002\u4E5F\u5C31\u662F\u8BF4\uFF0C\u5728\u521B\u5EFA PIT \u4E4B\u540E\u66F4\u65B0\u7684\u6570\u636E\u662F\u65E0\u6CD5\u88AB\u68C0\u7D22\u5230\u7684\u3002</p><p>\u5F53\u6211\u4EEC\u60F3\u8981\u83B7\u53D6\u3001\u7EDF\u8BA1\u4EE5\u5F53\u524D\u65F6\u95F4\u8282\u70B9\u4E3A\u51C6\u7684\u6570\u636E\u800C\u4E0D\u8003\u8651\u540E\u7EED\u6570\u636E\u66F4\u65B0\u7684\u65F6\u5019\uFF0CPIT \u5C31\u663E\u5F97\u975E\u5E38\u6709\u7528\u4E86\u3002\u4F7F\u7528 PIT \u524D\u9700\u8981\u663E\u5F0F\u4F7F\u7528 _pit API \u83B7\u53D6\u4E00\u4E2A PID ID\uFF1A</p><div class="language-"><pre><code># \u4F7F\u7528 pit API \u83B7\u53D6\u4E00\u4E2A PID ID
POST /my_index/_pit?keep_alive=20m

# \u7ED3\u679C
{
  &quot;id&quot;: &quot;46ToAwMDaWR5BXV1aWQy......==&quot;
}
</code></pre></div><p>\u5982\u4E0A\u793A\u4F8B\uFF0C\u4F7F\u7528 _pit \u63A5\u53E3\u83B7\u53D6\u4E86\u4E00\u4E2A PIT ID\uFF0Ckeep_alive \u53C2\u6570\u8BBE\u7F6E\u4E86\u8FD9\u4E2A\u89C6\u56FE\u7684\u6709\u6548\u65F6\u957F\u3002\u6709\u4E86\u8FD9\u4E2A PIT ID \u540E\u7EED\u7684\u67E5\u8BE2\u5C31\u53EF\u4EE5\u7ED3\u5408\u5B83\u6765\u8FDB\u884C\u4E86</p><p>PIT \u53EF\u4EE5\u7ED3\u5408 search after \u8FDB\u884C\u67E5\u8BE2\uFF0C\u80FD\u6709\u6548\u4FDD\u8BC1\u6570\u636E\u7684\u4E00\u81F4\u6027\u3002 PIT \u7ED3\u5408 search after \u7684\u6D41\u7A0B\u4E0E\u524D\u9762\u4ECB\u7ECD\u7684 search after \u5DEE\u4E0D\u591A\uFF0C\u4E3B\u8981\u533A\u522B\u662F\u9700\u8981\u5728\u8BF7\u6C42 body \u4E2D\u5E26\u4E0A PIT ID\uFF0C\u5176\u793A\u4F8B\u5982\u4E0B</p><div class="language-"><pre><code># \u7B2C\u4E00\u6B21\u8C03\u7528 search after\uFF0C\u56E0\u4E3A\u4F7F\u7528\u4E86 PIT\uFF0C\u8FD9\u4E2A\u65F6\u5019\u641C\u7D22\u4E0D\u9700\u8981\u6307\u5B9A index \u4E86\u3002
POST _search
{
  &quot;size&quot;: 2,
  &quot;query&quot;: { &quot;match_all&quot;: {} },
  &quot;pit&quot;: {
    &quot;id&quot;:  &quot;46ToAwMDaWR5BXV1aWQy......==&quot;, # \u6DFB\u52A0 PIT id
    &quot;keep_alive&quot;: &quot;5m&quot; # \u89C6\u56FE\u7684\u6709\u6548\u65F6\u957F
  },
  &quot;sort&quot;: [
    { &quot;price&quot;: &quot;desc&quot; } # \u6309\u4EF7\u683C\u5012\u5E8F\u6392\u5E8F
  ]
}

# \u7ED3\u679C
{
  &quot;pit_id&quot; : &quot;46ToAwMDaWR5BXV1aWQy......==&quot;,
  &quot;hits&quot; : {
    &quot;hits&quot; : [
      {
        &quot;_id&quot; : &quot;6&quot;,
        &quot;_source&quot; : {
          &quot;book_id&quot; : &quot;4ee82467&quot;,
          &quot;price&quot; : 20.9
        },
        &quot;sort&quot; : [20.9, 8589934593]
      },
      {
        &quot;_id&quot; : &quot;1&quot;,
        &quot;_source&quot; : {
          &quot;book_id&quot; : &quot;4ee82462&quot;
          &quot;price&quot; : 19.9
        },
        &quot;sort&quot; : [19.9, 8589934592]
      }
    ]
  }
}
</code></pre></div><p>\u5728 pit \u5B57\u6BB5\u4E2D\u6307\u5B9A PIT ID \u548C\u8BBE\u7F6E keep_alive \u6765\u6307\u5B9A\u89C6\u56FE\u7684\u6709\u6548\u65F6\u957F\u3002\u9700\u8981\u6CE8\u610F\u7684\u662F\uFF0C\u4F7F\u7528\u4E86 PIT \u540E\u4E5F\u4E0D\u9700\u8981\u5728\u8DEF\u5F84\u4E2D\u6307\u5B9A\u7D22\u5F15\u540D\u79F0\u4E86</p><p>\u5728\u5176\u8FD4\u56DE\u7ED3\u679C\u4E2D\uFF0Csort \u6570\u7EC4\u4E2D\u5305\u542B\u4E86\u4E24\u4E2A\u5143\u7D20\uFF0C\u5176\u4E2D\u7B2C\u4E00\u4E2A\u662F\u6211\u4EEC\u7528\u4F5C\u6392\u5E8F\u7684 price \u7684\u503C\uFF0C\u7B2C\u4E8C\u4E2A\u503C\u662F\u4E00\u4E2A\u9690\u542B\u7684\u6392\u5E8F\u503C\u3002\u6240\u6709\u7684 PIT \u8BF7\u6C42\u90FD\u4F1A\u81EA\u52A8\u52A0\u5165\u4E00\u4E2A\u9690\u5F0F\u7684\u7528\u4E8E\u6392\u5E8F\u7684\u5B57\u6BB5\u79F0\u4E3A\uFF1A_shard_doc\uFF0C\u5F53\u7136\u8FD9\u4E2A\u6392\u5E8F\u503C\u53EF\u4EE5\u663E\u5F0F\u6307\u5B9A\u3002\u8FD9\u4E2A\u9690\u542B\u7684\u5B57\u6BB5\u5B98\u65B9\u4E5F\u79F0\u5B83\u4E3A\uFF1Atiebreaker\uFF08\u51B3\u80DC\u5B57\u6BB5\uFF09\uFF0C\u5176\u4EE3\u8868\u7684\u662F\u6587\u6863\u7684\u552F\u4E00\u503C\uFF0C\u4FDD\u8BC1\u4E86\u5206\u9875\u4E0D\u4F1A\u4E22\u5931\u6216\u8005\u5206\u9875\u7ED3\u679C\u7684\u6570\u636E\u4E0D\u4F1A\u91CD\u590D\uFF0C\u5176\u4F5C\u7528\u5C31\u597D\u50CF\u539F search after \u7684 sort \u5B57\u6BB5\u4E2D\u8981\u6307\u5B9A\u7684\u552F\u4E00\u503C\u4E00\u6837\u3002</p><p>\u5728\u8FDB\u884C\u7FFB\u9875\u7684\u65F6\u5019\u548C\u539F search after \u4E00\u6837\uFF0C\u9700\u8981\u628A\u4E0A\u6B21\u7ED3\u679C\u4E2D\u6700\u540E\u4E00\u4E2A\u6587\u6863\u7684 sort \u503C\u5E26\u4E0A\uFF1A</p><div class="language-"><pre><code># \u7B2C\u4E8C\u6B21\u8C03\u7528 search after\uFF0C\u56E0\u4E3A\u4F7F\u7528\u4E86 PIT\uFF0C\u8FD9\u4E2A\u65F6\u5019\u641C\u7D22\u4E0D\u9700\u8981\u6307\u5B9A index \u4E86\u3002
POST _search
{
  &quot;size&quot;: 2,
  &quot;query&quot;: {
    &quot;match_all&quot;: {}
  },
  &quot;pit&quot;: {
    &quot;id&quot;:  &quot;46ToAwMDaWR5BXV1aWQy......==&quot;, # \u6DFB\u52A0 PIT id
    &quot;keep_alive&quot;: &quot;5m&quot; # \u89C6\u56FE\u7684\u6709\u6548\u65F6\u957F
  },
  &quot;search_after&quot;: [19.9, 8589934592], # \u4E0A\u6B21\u7ED3\u679C\u4E2D\u6700\u540E\u4E00\u4E2A\u6587\u6863\u7684 sort \u503C
  &quot;sort&quot;: [
    { &quot;price&quot;: &quot;desc&quot; }
  ]
}
</code></pre></div><h1 id="\u5E38\u89C1\u95EE\u9898" tabindex="-1">\u5E38\u89C1\u95EE\u9898 <a class="header-anchor" href="#\u5E38\u89C1\u95EE\u9898" aria-hidden="true">#</a></h1><h2 id="\u7CBE\u786E\u5339\u914D" tabindex="-1">\u7CBE\u786E\u5339\u914D <a class="header-anchor" href="#\u7CBE\u786E\u5339\u914D" aria-hidden="true">#</a></h2><h3 id="\u5FFD\u7565\u5927\u5C0F\u5199" tabindex="-1">\u5FFD\u7565\u5927\u5C0F\u5199 <a class="header-anchor" href="#\u5FFD\u7565\u5927\u5C0F\u5199" aria-hidden="true">#</a></h3><p>text\u7684\u521B\u5EFA\u6587\u6863\u65F6\u662F\u4F1A\u5206\u8BCD\u5E76\u4E14\u8F6C\u6210\u5C0F\u5199\u7684\uFF0C\u4F46\u662F\u7CBE\u786E\u5339\u914Dkeyword\u662F\u4E0D\u5206\u8BCD\u7684\uFF0C\u4E5F\u4E0D\u4F1A\u8F6C\u6210\u5C0F\u5199\u3002\u6709\u65F6\u5019\u6211\u4EEC\u60F3\u8981\u5FFD\u7565\u5927\u5C0F\u5199\u7684\u7CBE\u786E\u5339\u914D</p><p>\u9700\u8981\u5728\u521B\u5EFA\u7D22\u5F15\u7684\u65F6\u5019\uFF0C\u8BBE\u7F6E\u5FFD\u7565\u5927\u5C0F\u5199</p><div class="language-"><pre><code>{
  &quot;settings&quot;: {
    &quot;number_of_replicas&quot;: 1,
    &quot;number_of_shards&quot;: 0,
    # 1\u3001\u6307\u5B9A\u5FFD\u7565\u5927\u5C0F\u5199
    &quot;analysis&quot;: {
      &quot;normalizer&quot;: {
        &quot;lowercase_normalizer&quot;: {
          &quot;type&quot;: &quot;custom&quot;,
          &quot;char_filter&quot;: [],
          &quot;filter&quot;: [
            &quot;lowercase&quot;
          ]
        }
      }
    }
  },
  &quot;mappings&quot;: {
    &quot;tag&quot;: {
        &quot;type&quot;: &quot;keyword&quot;,
        # 2\u3001\u8BBE\u7F6E\u5FFD\u7565\u5927\u5C0F\u5199
        &quot;normalizer&quot;: &quot;lowercase_normalizer&quot;
      }
  }
}
</code></pre></div><p>\u4F7F\u7528case_insensitive\uFF0C\u4EC5\u652F\u6301term</p><div class="language-"><pre><code>{
  &quot;query&quot;: {
    &quot;term&quot;: {
      &quot;title&quot;: {
        &quot;value&quot;: &quot;Romeo&quot;,
        &quot;case_insensitive&quot;: true
      }
    }
  }
}
</code></pre></div><h2 id="\u5206\u8BCD\u6280\u5DE7" tabindex="-1">\u5206\u8BCD\u6280\u5DE7 <a class="header-anchor" href="#\u5206\u8BCD\u6280\u5DE7" aria-hidden="true">#</a></h2><p>\u7D22\u5F15\u65F6\u7528ik_max_word(\u6700\u7EC6\u7C92\u5EA6\u5212\u5206)\uFF0C\u5728\u641C\u7D22\u65F6\u7528ik_smart\uFF08\u6700\u5C11\u5207\u5206\uFF09 \u5373\uFF1A\u7D22\u5F15\u65F6\u6700\u5927\u5316\u7684\u5C06\u6587\u7AE0\u5185\u5BB9\u5206\u8BCD\uFF0C\u641C\u7D22\u65F6\u66F4\u7CBE\u786E\u7684\u641C\u7D22\u5230\u60F3\u8981\u7684\u7ED3\u679C\u3002</p><div class="language-"><pre><code>{
  &quot;mappings&quot;: {
    &quot;properties&quot;: {
      &quot;content&quot;: {
        &quot;type&quot;: &quot;text&quot;,
        &quot;analyzer&quot;: &quot;ik_max_word&quot;,
        &quot;fields&quot;: {
          &quot;keyword&quot;: {
            &quot;type&quot;: &quot;keyword&quot;,
            &quot;ignore_above&quot;: 256
          }
        }
      }
    }
  }
}

{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;title&quot;: {
        &quot;analyzer&quot;: &quot;ik_smart&quot;,
        &quot;query&quot;: &quot;\u6587\u7AE0&quot;
      }
    }
  }
}
</code></pre></div><h2 id="\u8FD4\u56DE\u6570\u636E\u5177\u4F53\u603B\u6761\u6570" tabindex="-1">\u8FD4\u56DE\u6570\u636E\u5177\u4F53\u603B\u6761\u6570 <a class="header-anchor" href="#\u8FD4\u56DE\u6570\u636E\u5177\u4F53\u603B\u6761\u6570" aria-hidden="true">#</a></h2><p>track_total_hits\u53C2\u6570\u9ED8\u8BA4\u4E3Afalse\uFF0C\u4E3Afalse\u65F6\uFF0C\u5F53\u641C\u7D22\u5230\u7684\u6570\u636E&gt;10000\u6761\uFF0C\u5219\u53EA\u663E\u793A10000\u6761\uFF0C\u4E3Atrue\u65F6\uFF0C\u53EF\u4EE5\u663E\u793A\u8BE6\u7EC6\u6761\u6570</p><h2 id="\u8FD4\u56DE\u6307\u5B9A\u5B57\u6BB5" tabindex="-1">\u8FD4\u56DE\u6307\u5B9A\u5B57\u6BB5 <a class="header-anchor" href="#\u8FD4\u56DE\u6307\u5B9A\u5B57\u6BB5" aria-hidden="true">#</a></h2><p>\u4E0D\u662F\u6240\u6709\u5B57\u6BB5\u90FD\u9700\u8981\u8FD4\u56DE\uFF0C\u53EF\u4EE5\u6307\u5B9A\u9700\u8981\u8FD4\u56DE\u7684\u5B57\u6BB5</p><p>\u53EF\u4EE5\u4F7F\u7528\u901A\u914D\u7B26*</p><div class="language-"><pre><code>{
  &quot;from&quot;: 0,
  &quot;size&quot;: 1,
  &quot;query&quot;: {},
  &quot;_source&quot;: {
    # \u6307\u5B9A\u8FD4\u56DE\u5B57\u6BB5
    &quot;includes&quot;: [
      &quot;title&quot;
    ],
    # \u6307\u5B9A\u4E0D\u8FD4\u56DE\u5B57\u6BB5
    &quot;excludes&quot;: [&quot;name&quot;,&quot;bir*&quot;]
  }
}
</code></pre></div><h2 id="copy-to" tabindex="-1">copy_to <a class="header-anchor" href="#copy-to" aria-hidden="true">#</a></h2><p>Elasticsearch\u5141\u8BB8\u5728\u6620\u5C04\u4E2D\u4E3A\u67D0\u4E2A\u5B57\u6BB5\u5B9A\u4E49copy_to\u53C2\u6570\uFF0C\u4EE5\u5B9E\u73B0\u590D\u5236\u591A\u4E2A\u5176\u4ED6\u5B57\u6BB5\u7684\u5185\u5BB9\uFF0C\u8FD9\u6837\u5728\u641C\u7D22\u4E00\u4E2A\u5B57\u6BB5\u65F6\u80FD\u591F\u8FBE\u5230\u540C\u65F6\u641C\u7D22\u591A\u4E2A\u5B57\u6BB5\u7684\u6548\u679C\uFF0C\u4F7F\u7528\u5B57\u6BB5\u590D\u5236\u6BD4\u4F7F\u7528\u591A\u5B57\u6BB5\u5339\u914DMulti_match\u6027\u80FD\u66F4\u597D\u3002</p><div class="language-"><pre><code>{
  &quot;mappings&quot;: {
    &quot;properties&quot;: {
      &quot;title&quot;: {
        &quot;type&quot;: &quot;text&quot;,
        &quot;copy_to&quot;: &quot;titleBrief&quot; # \u6307\u5B9Acopy_to
      },
      &quot;brief&quot;: {
        &quot;type&quot;: &quot;text&quot;,
        &quot;copy_to&quot;: &quot;titleBrief&quot; # \u6307\u5B9Acopy_to
      }
    }
  }
}


{
    {
    &quot;query&quot;: {
        &quot;match&quot;: {
        &quot;titleBrief&quot;: &quot;\u7EA2&quot;
        }
    }
    }
}
</code></pre></div><h2 id="\u6267\u884C\u6027\u80FD" tabindex="-1">\u6267\u884C\u6027\u80FD <a class="header-anchor" href="#\u6267\u884C\u6027\u80FD" aria-hidden="true">#</a></h2><p>Profile API \u7528\u4E8E\u67E5\u770B DSL \u6027\u80FD\u74F6\u9888\u3002\u53EA\u9700\u8981\u6DFB\u52A0 &quot;profile&quot;: true \u5373\u53EF\u67E5\u770B DSL \u7684\u6267\u884C\u6027\u80FD</p><div class="language-"><pre><code>{
  &quot;profile&quot;: true,
  &quot;query&quot;: {
    &quot;query_string&quot;: {
      &quot;query&quot;: &quot;tag:(taga) AND tag_type:(A OR b) AND user:(173)&quot;
    }
  }
}
</code></pre></div><h1 id="suggester-api\u641C\u7D22\u63D0\u793A" tabindex="-1">Suggester API\u641C\u7D22\u63D0\u793A <a class="header-anchor" href="#suggester-api\u641C\u7D22\u63D0\u793A" aria-hidden="true">#</a></h1><p>ES\u63D0\u4F9B\u4E86suggseter api\uFF0C\u63D0\u4F9B\u4E864\u79CD\u7C7B\u578B\u7684suggseters\uFF1ATerm Suggester\uFF08\u57FA\u4E8E\u5355\u8BCD\u7684\u7EA0\u9519\u8865\u5168\uFF09\u3001Phrase Suggester\uFF08\u57FA\u4E8E\u77ED\u8BED\u7684\u7EA0\u9519\u8865\u5168\uFF09\u3001Complete Suggester\uFF08\u81EA\u52A8\u8865\u5168\u5355\u8BCD\uFF0C\u8F93\u5165\u8BCD\u8BED\u7684\u524D\u534A\u90E8\u5206\uFF0C\u81EA\u52A8\u8865\u5168\u5355\u8BCD\uFF09\u3001Context Suggseter\uFF08\u57FA\u4E8E\u4E0A\u4E0B\u6587\u7684\u8865\u5168\u63D0\u793A\uFF0C\u53EF\u4EE5\u5B9E\u73B0\u4E0A\u4E0B\u6587\u611F\u77E5\u63A8\u8350\uFF09</p><h2 id="term-suggester" tabindex="-1">Term Suggester <a class="header-anchor" href="#term-suggester" aria-hidden="true">#</a></h2><p>\u5C06\u8F93\u5165\u7684\u6587\u672C\u5206\u89E3\u4E3AToken\uFF0C\u7136\u540E\u5728\u7D22\u5F15\u7684\u5B57\u6BB5\u91CC\u67E5\u627E\u76F8\u4F3C\u7684term\u8FD4\u56DE</p><div class="language-"><pre><code>{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;database&quot;: &quot;posgresql&quot;
    }
  },
  &quot;suggest&quot;: {
    &quot;my-term-suggestion&quot;: {
      &quot;text&quot;: &quot;posgresql&quot;,
      &quot;term&quot;: {
        &quot;suggest_mode&quot;: &quot;missing&quot;,
        &quot;field&quot;: &quot;database&quot;
      }
    },
    &quot;my-term-suggestion2&quot;: {
      &quot;text&quot;: &quot;oracla&quot;,
      &quot;term&quot;: {
        &quot;suggest_mode&quot;: &quot;missing&quot;,
        &quot;field&quot;: &quot;database&quot;
      }
    }
  }
}
</code></pre></div>`,198),g=[c];function m(_,f,v,y,x,b){return e(),o("div",null,g)}var T=t(h,[["render",m]]);export{I as __pageData,T as default};
